<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[SciRuby]]></title>
  <link href="http://SciRuby.github.com/atom.xml" rel="self"/>
  <link href="http://SciRuby.github.com/"/>
  <updated>2015-08-25T08:45:51-05:00</updated>
  <id>http://SciRuby.github.com/</id>
  <author>
    <name><![CDATA[SciRuby]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Statistical linear mixed models in Ruby with mixed_models (GSoC2015)]]></title>
    <link href="http://SciRuby.github.com/blog/2015/08/19/gsoc-2015-mixed-models/"/>
    <updated>2015-08-19T12:00:00-05:00</updated>
    <id>http://SciRuby.github.com/blog/2015/08/19/gsoc-2015-mixed-models</id>
    <content type="html"><![CDATA[<p>Google Summer of Code 2015 is coming to an end. During this summer, I have learned too many things to list here about statistical modeling, Ruby and software development in general, and I had a lot of fun in the process!</p>

<h2>Linear mixed models</h2>

<p>My GSoC project is the Ruby gem <a href="https://github.com/agisga/mixed_models">mixed_models</a>. Mixed models are statistical models which predict the value of a response variable as a result of fixed and random effects. The gem in its current version can be used to fit statistical linear mixed models and perform statistical inference on the model parameters as well as to predict future observations. A number of tutorials/examples in IRuby notebook format are accessible from the <code>mixed_models</code> <a href="https://github.com/agisga/mixed_models">github repository</a>.</p>

<p>Linear mixed models are implemented in the class <code>LMM</code>. The constructor method <code>LMM#initialize</code> provides a flexible model specification interface, where an arbitrary covariance structure of the random effects terms can be passed as a <code>Proc</code> or a block.</p>

<p>A convenient user-friendly interface to the basic model fitting algorithm is <code>LMM#from_formula</code>, which uses the formula language of the R mixed models package <code>lme4</code> for model specification. With the <code>#from_formula</code> method, the user can conveniently fit models with categorical predictor variables, interaction fixed or random effects, as well as multiple crossed or nested random effects, all with just one line of code.</p>

<p>Examples are given in the sections below.</p>

<h3>Implementation</h3>

<p>The parameter estimation in <code>LMM#initialize</code> is largely based on the approach developed by the authors of the R mixed models package <code>lme4</code>, which is delineated in the <code>lme4</code> <a href="https://cran.r-project.org/web/packages/lme4/vignettes/lmer.pdf">vignette</a>. I have tried to make the code of the model fitting algorithm in <code>LMM#initialize</code> easy to read, especially compared to the corresponding implementation in <code>lme4</code>.</p>

<p>The <code>lme4</code> code is largely written in C++, which is integrated in R via the packages <code>Rcpp</code> and <code>RcppEigen</code>. It uses <a href="https://developer.nvidia.com/cholmod">CHOLMOD</a> code for various sparse matrix tricks, and it involves passing pointers to C++ object to R (and vice versa) many times, and passing different R environments from function to function. All this makes the <code>lme4</code> code rather hard to read. Even Douglas Bates, the main developer of <code>lme4</code>, admits that <a href="https://stat.ethz.ch/pipermail/r-sig-mixed-models/2014q4/022791.html">&#8220;The end result is confusing (my fault entirely) and fragile&#8221;</a>, because of all the utilized performance improvements. I have analyzed the <code>lme4</code> code in three blog posts (<a href="http://agisga.github.io/Dissect_lmer_part1/">part 1</a>, <a href="http://agisga.github.io/Dissect_lmer_part2/">part 2</a> and <a href="http://agisga.github.io/Dissect_lmer_part3/">part 3</a>) before starting to work on my gem <code>mixed_models</code>.</p>

<p>The method <code>LMM#initialize</code> is written in a more functional style, which makes the code shorter and (I find) easier to follow.  All matrix calculations are performed using the gem <a href="https://github.com/SciRuby/nmatrix"><code>nmatrix</code></a>, which has a quite intuitive syntax and contributes to the overall code readability as well.
The Ruby gem loses with respect to memory consumption and speed in comparison to <code>lme4</code>, because it is written in pure Ruby and does not utilize any sparse matrix tricks. However, for the same reasons the <code>mixed_models</code> code is much shorter and easier to read than <code>lme4</code>. Moreover, the linear mixed model formulation in <code>mixed_models</code> is a little bit more general, because it does not assume that the random effects covariance matrix is sparse. More about the implementation of <code>LMM#initialize</code> can be found in <a href="http://agisga.github.io/First-linear-mixed-model-fit/">this blog post</a>.</p>

<h3>Other existing tools</h3>

<p>Popular existing software packages for mixed models include the R package <a href="https://cran.r-project.org/web/packages/lme4/index.html"><code>lme4</code></a> (which is arguably the standard software for linear mixed models), the R package <a href="https://cran.r-project.org/web/packages/nlme/index.html"><code>nlme</code></a> (an older package developed by the same author as <code>lme4</code>, still widely used), Python&#8217;s <a href="https://github.com/statsmodels/statsmodels/blob/master/statsmodels/regression/mixed_linear_model.py"><code>statmodels</code></a>, and the Julia package <a href="https://github.com/dmbates/MixedModels.jl"><code>MixedModels.jl</code></a>.</p>

<p>Below, I give a couple of examples illustrating some of the capabilities of <code>mixed_models</code> and explore how it compares to the alternatives.</p>

<h3>A usage example and discussion</h3>

<p>As an example, we use <a href="http://archive.ics.uci.edu/ml/datasets/BlogFeedback">data</a> from the UCI machine learning repository, which originate from blog posts from various sources in 2010-2012, in order to model (the logarithm of) the number of comments that a blog post receives. The linear predictors are the text length, the log-transform of the average number of comments at the hosting website, the average number of trackbacks at the hosting website, and the parent blog posts. We assume a random effect on the number of comments due to the day of the week on which the blog post was published. In <code>mixed_models</code> this model can be fit with</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">model_fit</span> <span class="o">=</span> <span class="no">LMM</span><span class="o">.</span><span class="n">from_formula</span><span class="p">(</span><span class="n">formula</span><span class="p">:</span> <span class="s2">&quot;log_comments ~ log_host_comments_avg + host_trackbacks_avg + length + has_parent_with_comments + (1 | day)&quot;</span><span class="p">,</span>
</span><span class='line'>                              <span class="n">data</span><span class="p">:</span> <span class="n">blog_data</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>and we can display some information about the estimated fixed effects with</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">puts</span> <span class="n">model_fit</span><span class="o">.</span><span class="n">fix_ef_summary</span><span class="o">.</span><span class="n">inspect</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>which produces the following output:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>                                         <span class="n">coef</span>                       <span class="n">sd</span>                  <span class="n">z_score</span>            <span class="no">WaldZ_p_value</span>
</span><span class='line'>           <span class="n">intercept</span>       <span class="mi">1</span><span class="o">.</span><span class="mi">2847896684307731</span>     <span class="mi">0</span><span class="o">.</span><span class="mo">0303</span><span class="mi">80582281933178</span>        <span class="mi">42</span><span class="o">.</span><span class="mi">28983027737477</span>                      <span class="mi">0</span><span class="o">.</span><span class="mi">0</span>
</span><span class='line'>   <span class="n">log_host_comments_avg</span>        <span class="mi">0</span><span class="o">.</span><span class="mi">415586319225577</span>     <span class="mi">0</span><span class="o">.</span><span class="mo">007</span><span class="mi">848368759350875</span>        <span class="mi">52</span><span class="o">.</span><span class="mi">95193586953086</span>                      <span class="mi">0</span><span class="o">.</span><span class="mi">0</span>
</span><span class='line'> <span class="n">host_trackbacks_avg</span>     <span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mo">075515</span><span class="mi">88997745964</span>     <span class="mi">0</span><span class="o">.</span><span class="mo">010</span><span class="mi">915623834434068</span>       <span class="o">-</span><span class="mi">6</span><span class="o">.</span><span class="mi">918146971979714</span>    <span class="mi">4</span><span class="o">.</span><span class="mi">575895218295045</span><span class="n">e</span><span class="o">-</span><span class="mi">12</span>
</span><span class='line'>              <span class="n">length</span>   <span class="mi">1</span><span class="o">.</span><span class="mi">8245853808280765</span><span class="n">e</span><span class="o">-</span><span class="mo">05</span>    <span class="mi">2</span><span class="o">.</span><span class="mi">981631039432429</span><span class="n">e</span><span class="o">-</span><span class="mo">06</span>        <span class="mi">6</span><span class="o">.</span><span class="mi">119420400102211</span>    <span class="mi">9</span><span class="o">.</span><span class="mi">391631916599863</span><span class="n">e</span><span class="o">-</span><span class="mi">10</span>
</span><span class='line'><span class="n">has_parent_with_comments</span>      <span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">4616662830553772</span>      <span class="mi">0</span><span class="o">.</span><span class="mi">13936886611993773</span>      <span class="o">-</span><span class="mi">3</span><span class="o">.</span><span class="mi">3125496095955715</span>    <span class="mi">0</span><span class="o">.</span><span class="mo">000</span><span class="mi">9244972814528296</span>
</span></code></pre></td></tr></table></div></figure>


<p>We can also display the estimated random effects coefficients and the random effects standard deviation,</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">puts</span> <span class="s2">&quot;Random effects coefficients:&quot;</span>
</span><span class='line'><span class="nb">puts</span> <span class="n">model_fit</span><span class="o">.</span><span class="n">ran_ef</span>
</span><span class='line'><span class="nb">puts</span> <span class="s2">&quot;Random effects correlation structure:&quot;</span>
</span><span class='line'><span class="nb">puts</span> <span class="n">model_fit</span><span class="o">.</span><span class="n">ran_ef_summary</span><span class="o">.</span><span class="n">inspect</span>
</span></code></pre></td></tr></table></div></figure>


<p>which produces</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Random</span> <span class="n">effects</span> <span class="n">coefficients</span><span class="p">:</span>
</span><span class='line'><span class="p">{</span><span class="ss">:intercept_fr</span><span class="o">=&gt;</span><span class="mi">0</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="ss">:intercept_mo</span><span class="o">=&gt;</span><span class="mi">0</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="ss">:intercept_sa</span><span class="o">=&gt;</span><span class="mi">0</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="ss">:intercept_su</span><span class="o">=&gt;</span><span class="mi">0</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="ss">:intercept_th</span><span class="o">=&gt;</span><span class="mi">0</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="ss">:intercept_tu</span><span class="o">=&gt;</span><span class="mi">0</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="ss">:intercept_we</span><span class="o">=&gt;</span><span class="mi">0</span><span class="o">.</span><span class="mi">0</span><span class="p">}</span>
</span><span class='line'><span class="no">Random</span> <span class="n">effects</span> <span class="n">standard</span> <span class="n">deviation</span><span class="p">:</span>
</span><span class='line'>
</span><span class='line'><span class="c1">#&lt;Daru::DataFrame:70278348234580 @name = 8e11a27f-81b0-48a0-9771-085a8f30693d @size = 1&gt;</span>
</span><span class='line'>                  <span class="n">day</span>
</span><span class='line'>       <span class="n">day</span>        <span class="mi">0</span><span class="o">.</span><span class="mi">0</span>
</span></code></pre></td></tr></table></div></figure>


<p>Interestingly, the estimates of the random effects coefficients and standard deviation are all zero!
That is, we have a singular fit. Thus, our results imply that the day of the week on which a blog post is published has no effect on the number of comments that the blog post will receive.</p>

<p>It is worth pointing out that such a model fit with a singular covariance matrix is problematic with the current version of Python&#8217;s <code>statmodels</code> (described as &#8220;numerically challenging&#8221; in the <a href="http://statsmodels.sourceforge.net/devel/mixed_linear.html">documentation</a>) and the R package <code>nlme</code> (&#8220;Singular covariance matrices correspond to infinite parameter values&#8221;, a <a href="https://stat.ethz.ch/pipermail/r-sig-mixed-models/2014q4/022791.html">mailing list reply</a> by Douglas Bates, the author of <code>nlme</code>). However, <code>mixed_models</code>, <code>lme4</code> and <code>MixedModels.jl</code> can handle singular fits without problems.
In fact, like <code>mixed_models</code> above, <code>lme4</code> estimates the random effects coefficients and standard deviation to be zero, as we can see from the following R output:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='rconsole'><span class='line'><span class="gp">&gt; </span>mod <span class="o">&lt;-</span> lmer<span class="p">(</span>log_comments ~ log_host_comments_avg <span class="o">+</span> host_trackbacks_avg <span class="o">+</span> length <span class="o">+</span> has_parent_with_comments <span class="o">+</span> <span class="p">(</span><span class="m">1</span><span class="o">|</span>day<span class="p">),</span> data <span class="o">=</span> df<span class="p">)</span>
</span><span class='line'><span class="go">Warning message:</span>
</span><span class='line'><span class="go">Some predictor variables are on very different scales: consider rescaling </span>
</span><span class='line'><span class="gp">&gt; </span>ranef<span class="p">(</span>mod<span class="p">)</span>
</span><span class='line'><span class="go">$day</span>
</span><span class='line'><span class="go">   (Intercept)</span>
</span><span class='line'><span class="go">fr           0</span>
</span><span class='line'><span class="go">mo           0</span>
</span><span class='line'><span class="go">sa           0</span>
</span><span class='line'><span class="go">su           0</span>
</span><span class='line'><span class="go">th           0</span>
</span><span class='line'><span class="go">tu           0</span>
</span><span class='line'><span class="go">we           0</span>
</span><span class='line'>
</span><span class='line'><span class="gp">&gt; </span>VarCorr<span class="p">(</span>mod<span class="p">)</span>
</span><span class='line'><span class="go"> Groups   Name        Std.Dev.</span>
</span><span class='line'><span class="go"> day      (Intercept) 0.0000  </span>
</span><span class='line'><span class="go"> Residual             1.2614</span>
</span></code></pre></td></tr></table></div></figure>


<p>Unfortunately, <code>mixed_models</code> is rather slow when applied to such a large data set (<code>blog_data</code> is a data frame of size 22435&times;8), especially when compared to <code>lme4</code> which uses many sparse matrix tricks and is mostly written in C++ (integrated in R via <code>Rcpp</code>) to speed up computation. The difference in performance between <code>mixed_models</code> and <code>lme4</code> is on the order of hours for large data, and Julia&#8217;s <code>MixedModels.jl</code> promises to be even faster than <code>lme4</code>. However, there is no noticeable difference in performance speed for smaller data sets.</p>

<p><a href="http://nbviewer.ipython.org/github/agisga/mixed_models/blob/master/notebooks/blog_data.ipynb">The full data analysis of the blog post data can be found in this IRuby notebook</a>.</p>

<h3>A second example and statistical inference on the parameter estimates</h3>

<p>Often, the experimental design or the data suggests a linear mixed model whose random effects are associated with multiple grouping factors. A specification of multiple random effects terms which correspond to multiple grouping factors is often referred to as <em>crossed random effect</em>, or <em>nested random effects</em> if the corresponding grouping factors are nested in each other.
A good reference on such models is <a href="http://lme4.r-forge.r-project.org/book/Ch2.pdf">Chapter 2</a> of Douglas Bates&#8217; <code>lme4</code> book.</p>

<p>Like <code>lme4</code>, <code>mixed_models</code> is particularly well suited for models with crossed or nested random effects. The current release of <code>statmodels</code>, however, does not support crossed or nested random effects (according to the <a href="http://statsmodels.sourceforge.net/devel/mixed_linear.html">documentation</a>).</p>

<p>As an example we fit a linear mixed model with nested random effects to a data frame with 100 rows, of the form:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1">#&lt;Daru::DataFrame:69912847885160 @name = 2b161c5d-00de-4240-be50-8fa84f3aed24 @size = 5&gt;</span>
</span><span class='line'>                    <span class="n">a</span>          <span class="n">b</span>          <span class="n">x</span>          <span class="n">y</span>
</span><span class='line'>         <span class="mi">0</span>         <span class="n">a3</span>         <span class="n">b1</span> <span class="mi">0</span><span class="o">.</span><span class="mi">38842531</span> <span class="mi">5</span><span class="o">.</span><span class="mi">10364866</span>
</span><span class='line'>         <span class="mi">1</span>         <span class="n">a3</span>         <span class="n">b2</span> <span class="mi">0</span><span class="o">.</span><span class="mi">44622300</span> <span class="mi">6</span><span class="o">.</span><span class="mi">23307061</span>
</span><span class='line'>         <span class="mi">2</span>         <span class="n">a3</span>         <span class="n">b1</span> <span class="mi">1</span><span class="o">.</span><span class="mi">54993657</span> <span class="mi">12</span><span class="o">.</span><span class="mi">2050404</span>
</span><span class='line'>         <span class="mi">3</span>         <span class="n">a3</span>         <span class="n">b1</span> <span class="mi">1</span><span class="o">.</span><span class="mi">52786614</span> <span class="mi">12</span><span class="o">.</span><span class="mo">00675</span><span class="mi">95</span>
</span><span class='line'>         <span class="mi">4</span>         <span class="n">a3</span>         <span class="n">b2</span> <span class="mi">0</span><span class="o">.</span><span class="mi">76011212</span> <span class="mi">8</span><span class="o">.</span><span class="mi">20054527</span>
</span></code></pre></td></tr></table></div></figure>


<p>We consider the following model:</p>

<ul>
<li>We take <code>y</code> to be the response and <code>x</code> its predictor.</li>
<li>We consider the factor <code>b</code> to be nested within the factor <code>a</code>.</li>
<li>We assume that the intercept varies due to variable <code>a</code>; that is, a different (random) intercept term for each level of <code>a</code>.</li>
<li>Moreover, we assume that the intercept varies due to the factor <code>b</code> which is nested in <code>a</code>; that is, different (random) intercept for each combination of levels of <code>a</code> and <code>b</code>.</li>
</ul>


<p>That is, mathematically the model can be expressed as</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">y</span> <span class="o">=</span> <span class="n">beta_0</span> <span class="o">+</span> <span class="n">beta_1</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">gamma</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">delta</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="n">epsilon</span>
</span></code></pre></td></tr></table></div></figure>


<p>where <code>gamma(a) ~ N(0, phi**2)</code> and <code>delta(a,b) ~ N(0, psi**2)</code> are normally distributed random variables which assume different realizations for different values of <code>a</code> and <code>b</code>, and where <code>epsilon</code> is a random Gaussian noise term with variance <code>sigma**2</code>. The goal is to estimate the parameters <code>beta_0</code>, <code>beta_1</code>, <code>phi</code>, <code>psi</code> and <code>sigma</code>.</p>

<p>We fit this model in <code>mixed_models</code>, and display the estimated random effects correlation structure with</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">mod</span> <span class="o">=</span> <span class="no">LMM</span><span class="o">.</span><span class="n">from_formula</span><span class="p">(</span><span class="n">formula</span><span class="p">:</span> <span class="s2">&quot;y ~ x + (1|a) + (1|a:b)&quot;</span><span class="p">,</span>
</span><span class='line'>                       <span class="n">data</span><span class="p">:</span> <span class="n">df</span><span class="p">,</span> <span class="n">reml</span><span class="p">:</span> <span class="kp">false</span><span class="p">)</span>
</span><span class='line'><span class="nb">puts</span> <span class="n">mod</span><span class="o">.</span><span class="n">ran_ef_summary</span><span class="o">.</span><span class="n">inspect</span>
</span></code></pre></td></tr></table></div></figure>


<p>which produces the output</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>                <span class="n">a</span>    <span class="n">a_and_b</span>
</span><span class='line'>     <span class="n">a</span> <span class="mi">1</span><span class="o">.</span><span class="mi">34108300</span>        <span class="kp">nil</span>
</span><span class='line'>   <span class="n">a_and_b</span>        <span class="kp">nil</span> <span class="mi">0</span><span class="o">.</span><span class="mi">97697500</span>
</span></code></pre></td></tr></table></div></figure>


<p>The correlation between the factor <code>a</code> and the nested random effect <code>a_and_b</code> is denoted as <code>nil</code>, because the random effects in the model at hand are assumed to be independent.</p>

<p>An advantage of <code>mixed_models</code> over some other tools is the simplicity with which p-values and confidence intervals for the parameter estimates can be calculated using a multitude of available methods. Such methods include a likelihood ratio test implementation, multiple bootstrap based methods (which run in parallel by default), and methods based on the Wald Z statistic.</p>

<p>We can compute five types of 95% confidence intervals for the fixed effects coefficients with the following line of code:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">mod</span><span class="o">.</span><span class="n">fix_ef_conf_int</span><span class="p">(</span><span class="nb">method</span><span class="p">:</span> <span class="ss">:all</span><span class="p">,</span> <span class="n">nsim</span><span class="p">:</span> <span class="mi">1000</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>which yields the result</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>                                      <span class="n">intercept</span>                                        <span class="n">x</span>
</span><span class='line'><span class="n">wald_z</span> <span class="o">[-</span><span class="mi">1</span><span class="o">.</span><span class="mo">0442515623151203</span><span class="p">,</span> <span class="mi">2</span><span class="o">.</span><span class="mi">433416817887737</span><span class="o">]</span>   <span class="o">[</span><span class="mi">4</span><span class="o">.</span><span class="mi">302419420148841</span><span class="p">,</span> <span class="mi">5</span><span class="o">.</span><span class="mo">03</span><span class="mi">8899876985704</span><span class="o">]</span>
</span><span class='line'><span class="n">boot_basic</span> <span class="o">[-</span><span class="mi">0</span><span class="o">.</span><span class="mi">9676586601496888</span><span class="p">,</span> <span class="mi">2</span><span class="o">.</span><span class="mi">486799230544233</span><span class="o">]</span>    <span class="o">[</span><span class="mi">4</span><span class="o">.</span><span class="mi">30540212917657</span><span class="p">,</span> <span class="mi">5</span><span class="o">.</span><span class="mo">02</span><span class="mi">8701160534481</span><span class="o">]</span>
</span><span class='line'> <span class="n">boot_norm</span> <span class="o">[-</span><span class="mi">1</span><span class="o">.</span><span class="mo">05755200</span><span class="mi">80398213</span><span class="p">,</span> <span class="mi">2</span><span class="o">.</span><span class="mi">4667867000424115</span>   <span class="o">[</span><span class="mi">4</span><span class="o">.</span><span class="mi">295959190826356</span><span class="p">,</span> <span class="mi">5</span><span class="o">.</span><span class="mo">0433</span><span class="mi">82379744274</span><span class="o">]</span>
</span><span class='line'><span class="n">boot_t</span> <span class="o">[-</span><span class="mi">0</span><span class="o">.</span><span class="mi">9676586601496886</span><span class="p">,</span> <span class="mi">2</span><span class="o">.</span><span class="mi">486799230544233</span><span class="o">]</span>    <span class="o">[</span><span class="mi">4</span><span class="o">.</span><span class="mi">30540212917657</span><span class="p">,</span> <span class="mi">5</span><span class="o">.</span><span class="mo">02</span><span class="mi">8701160534481</span><span class="o">]</span>
</span><span class='line'> <span class="n">boot_perc</span> <span class="o">[-</span><span class="mi">1</span><span class="o">.</span><span class="mi">0976339749716164</span><span class="p">,</span> <span class="mi">2</span><span class="o">.</span><span class="mi">3568239157223054</span>   <span class="o">[</span><span class="mi">4</span><span class="o">.</span><span class="mi">312618136600064</span><span class="p">,</span> <span class="mi">5</span><span class="o">.</span><span class="mo">035</span><span class="mi">917167957975</span><span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>For example, we see here that the intercept term is likely not significantly different from zero. We could proceed now by performing hypotheses tests using <code>#fix_ef_p</code> or <code>#likelihood_ratio_test</code>, or by refitting a model without an intercept using <code>#drop_fix_ef</code>.</p>

<p>We can also test the nested random effect for significance, in order to decide whether we should drop that term from the model to reduce model complexity. We can use a bootstrap based version of likelihood ratio test as follows.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">mod</span><span class="o">.</span><span class="n">ran_ef_p</span><span class="p">(</span><span class="n">variable</span><span class="p">:</span> <span class="ss">:intercept</span><span class="p">,</span> <span class="n">grouping</span><span class="p">:</span> <span class="o">[</span><span class="ss">:a</span><span class="p">,</span> <span class="ss">:b</span><span class="o">]</span><span class="p">,</span>
</span><span class='line'>             <span class="nb">method</span><span class="p">:</span> <span class="ss">:bootstrap</span><span class="p">,</span> <span class="n">nsim</span><span class="p">:</span> <span class="mi">1000</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>We get a p-value of 9.99e-4, suggesting that we probably should keep the term <code>(1|a:b)</code> in the model formula.</p>

<h3>A third example &mdash; a less conventional model fit</h3>

<p>Another advantage of <code>mixed_models</code> against comparable tools is the ease of fitting models with arbitrary covariance structures of the random effects, which are not covered by the formula interface of <code>lme4</code>. This can be done in a user-friendly manner by providing a block or a <code>Proc</code> to the <code>LMM</code> constructor. This unique feature of the Ruby language makes the implementation and usage of the method incredibly convenient. A danger of allowing for arbitrary covariance structures is, of course, that such a flexibility gives the user the freedom to specify degenerate and computationally unstable  models.</p>

<p>As an example we look at an application to genetics, namely to SNP data (<a href="https://en.wikipedia.org/wiki/Single-nucleotide_polymorphism">single-nucleotide polymorphism</a>) with known pedigree structures (family relationships of the subjects). The family information is prior knowledge that we can model in the random effects of a linear mixed effects model.</p>

<p>We model the quantitative trait <code>y</code> (a vector of length 1200) as</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">y</span> <span class="o">=</span> <span class="n">X</span> <span class="o">*</span> <span class="n">beta</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">epsilon</span><span class="p">,</span>
</span></code></pre></td></tr></table></div></figure>


<p>where <code>X</code> is a <code>1200 x 130</code> matrix containing the genotypes (i.e. 130 SNPs for each of the 1200 subjects); <code>epsilon</code> is a vector of independent random noise terms with variances equal to <code>sigma**2</code>; <code>beta</code> is a vector of unknown fixed effects coefficients measuring the contribution of each SNP to the quantitative trait <code>y</code>; and <code>b</code> is a vector of random effects.</p>

<p>If we denote the kinship matrix by <code>K</code>, then we can express the probability distribution of <code>b</code> as <code>b ~ N(0, delta**2 * 2 * K)</code>, where we multiply <code>K</code> by <code>2</code> because the diagonal of <code>K</code> is constant <code>0.5</code>, and where <code>delta**2</code> is a unknown scaling factor.</p>

<p>The goal is to estimate the unknown parameters <code>beta</code>, <code>sigma</code>, and <code>delta</code>, and to determine which of the fixed effects coefficients are significantly different from 0 (i.e. which SNPs are possibly causing the variability in the trait <code>y</code>).</p>

<p>In order to specify the covariance structure of the random effects, we need to pass a block or <code>Proc</code> that produces the upper triangular Cholesky factor of the covariance matrix of the random effects from an input Array. In this example, that would be the multiplication of the prior known Cholesky factor of the kinship matrix with a scaling factor.</p>

<p>Having all the model matrices and vectors, we compute the Cholesky factor of the kinship matrix and fit the model with</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># upper triangulat Cholesky factor</span>
</span><span class='line'><span class="n">kinship_mat_cholesky_factor</span> <span class="o">=</span> <span class="n">kinship_mat</span><span class="o">.</span><span class="n">factorize_cholesky</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># Fit the model</span>
</span><span class='line'><span class="n">model_fit</span> <span class="o">=</span> <span class="no">LMM</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span> <span class="n">zt</span><span class="p">:</span> <span class="n">z</span><span class="p">,</span>
</span><span class='line'>                    <span class="n">x_col_names</span><span class="p">:</span> <span class="n">x_names</span><span class="p">,</span>
</span><span class='line'>                    <span class="n">start_point</span><span class="p">:</span> <span class="o">[</span><span class="mi">2</span><span class="o">.</span><span class="mi">0</span><span class="o">]</span><span class="p">,</span>
</span><span class='line'>                    <span class="n">lower_bound</span><span class="p">:</span> <span class="o">[</span><span class="mi">0</span><span class="o">.</span><span class="mi">0</span><span class="o">]</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">th</span><span class="o">|</span> <span class="n">kinship_mat_cholesky_factor</span> <span class="o">*</span> <span class="n">th</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then we can use the available hypotheses test and confidence interval methods to determine which SNPs are significant predictors of the quantitative trait. Out of the 130 SNPs in the model, we find 24 to be significant as linear predictors.</p>

<p>See <a href="http://agisga.github.io/mixed_models_applied_to_family_SNP_data/">this blog post</a> for a full analysis of this data with <code>mixed_models</code>.</p>

<h2>Room for improvement and future work</h2>

<ul>
<li><p>Writing the formula language interpretation code used by <code>LMM#from_formula</code> from scratch was not easy. Much of the code can be reorganized to be easier to read and to use in other projects. Possibly, the formula interface should be separated out, similar to how it is done with the Python package <a href="https://github.com/pydata/patsy">patsy</a>. Also, some shortcut symbols (namely <code>*</code>, <code>/</code>, and <code>||</code>) in the model specification formula language are currently not implemented.</p></li>
<li><p>I plan to add linear mixed models for high-dimensional data (i.e. more predictors than observations) to <code>mixed_models</code>, because that work would be in line with my current PhD research.</p></li>
<li><p>I plan to add generalized linear mixed models capabilities to <code>mixed_models</code>, which can be used to fit mixed models to discrete data (such as binary or count data).</p></li>
</ul>


<h2>Acknowledgement</h2>

<p>I want to thank Google and the <a href="sciruby.com">Ruby Science Foundation</a> for giving me this excellent opportunity! I especially want to thank <a href="http://thebird.nl/">Pjotr Prins</a> who was my mentor for the project for much helpful advice and suggestions as well as his prompt responses to any of my concerns. I also want to thank my fellow GSoC participants <a href="https://github.com/wlevine">Will</a>, <a href="https://github.com/dilcom">Ivan</a>, and <a href="https://github.com/v0dro">Sameer</a> for their help with certain aspects of my project.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[GSoC 2015: New NMatrix gems for advanced linear algebra features]]></title>
    <link href="http://SciRuby.github.com/blog/2015/08/19/gsoc-2015-nmatrix/"/>
    <updated>2015-08-19T09:57:00-05:00</updated>
    <id>http://SciRuby.github.com/blog/2015/08/19/gsoc-2015-nmatrix</id>
    <content type="html"><![CDATA[<p>My Google Summer of Code project was working on the <a href="https://github.com/SciRuby/nmatrix">NMatrix project</a>, moving
functionality that depends on external libraries from the core <code>nmatrix</code>
gem to optional plugin gems. NMatrix is a Ruby library for linear algebra,
used by many other projects.
In addition to the code that was part of
NMatrix proper, NMatrix previously required the <a href="http://math-atlas.sourceforge.net/">ATLAS library</a>, which
implemented fast versions of common matrix operations like multiplication
and inversion, as well as more advanced operations like eigenvalue
decomposition and Cholesky decomposition.</p>

<p>There were two separate but related motivations for my project. The
first was to simplify the NMatrix installation
process. ATLAS can be difficult to install, so the installation
process for NMatrix was complicated, especially on
OS X, and may have discouraged people from using NMatrix.
The second motivation was that by separating out the ATLAS code from the
main NMatrix code, it would be easier to add new linear algebra backends
which provide similar features. Indeed, I implemented a second backend this
summer.</p>

<p>The end result of my summer&#8217;s work:</p>

<ul>
<li>The core <code>nmatrix</code> gem does not depend on any external linear matrix
libraries. It provides non-optimized implementations of common matrix
operations.</li>
<li>All code that requires ATLAS has been moved into the new <code>nmatrix-atlas</code>
gem, so that
those who are only interested in the core functionality are not required to
install ATLAS. <code>nmatrix-atlas</code> provides optimized implementations of common matrix
operations, as well as advanced functions not available in <code>nmatrix</code>.
I wrote a blog post describing the setup for <a href="http://wlevine.github.io/2015/06/15/releasing-multiple-gems-with-c-extensions-from-the-same-repository.html">releasing multiple gems from the same repository</a>, which this required.</li>
<li>A new gem <code>nmatrix-lapacke</code>, which provides the same features as
<code>nmatrix-atlas</code>, but instead of depending specifically on the ATLAS
library, requires any generic <a href="https://en.wikipedia.org/wiki/LAPACK">LAPACK</a> and
<a href="https://en.wikipedia.org/wiki/Basic_Linear_Algebra_Subprograms">BLAS</a>
implementation. This should be easier to use for many users as they may
already have LAPACK installed (it comes pre-installed with OS X and is
commonly used in Linux systems), but not ATLAS.</li>
<li>The installation procedure is simplified, especially for those installing
just the <code>nmatrix</code> gem. Compare the <a href="https://github.com/SciRuby/nmatrix/wiki/Installation">new installation instructions</a>
to the <a href="https://github.com/SciRuby/nmatrix/wiki/Installation/2ac41c62d35c79468d3d8169be0ccba238c3c921">old ones</a>.</li>
</ul>


<p>The one deviation from my original proposal was that I originally intended to remove
all the ATLAS code and release only the <code>nmatrix-lapacke</code> plugin, so that we
would only have one interface to the advanced linear algebra functions, but I
decided to keep the ATLAS code, since the <code>nmatrix-lapacke</code> code is new and
has not had a chance to be thoroughly tested.</p>

<h3>Usage</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;nmatrix&#39;</span>
</span><span class='line'><span class="c1"># create a 3-by-3 matrix</span>
</span><span class='line'><span class="n">a</span> <span class="o">=</span> <span class="no">NMatrix</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="o">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="o">]</span><span class="p">,</span> <span class="o">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="o">]</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="ss">:float64</span><span class="p">)</span>
</span><span class='line'><span class="c1">#invert it using non-optimized NMatrix-internal implementation</span>
</span><span class='line'><span class="n">a</span><span class="o">.</span><span class="n">invert!</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;nmatrix&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;nmatrix/atlas&#39;</span> <span class="c1">#or require &#39;nmatrix/lapacke&#39;</span>
</span><span class='line'><span class="c1"># create a 3-by-3 matrix</span>
</span><span class='line'><span class="n">a</span> <span class="o">=</span> <span class="no">NMatrix</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="o">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="o">]</span><span class="p">,</span> <span class="o">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="o">]</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="ss">:float64</span><span class="p">)</span>
</span><span class='line'><span class="c1">#invert it using optimized implementation provided by ATLAS</span>
</span><span class='line'><span class="n">a</span><span class="o">.</span><span class="n">invert!</span>
</span></code></pre></td></tr></table></div></figure>


<p>For advanced functions not provided by the core <code>nmatrix</code> gem, for example
<a href="http://sciruby.com/nmatrix/docs/NMatrix.html#method-i-gesvd"><code>gesvd</code></a>, <code>nmatrix-atlas</code> and <code>nmatrix-lapacke</code>
provide a common interface:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;nmatrix&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;nmatrix/atlas&#39;</span>
</span><span class='line'><span class="n">a</span> <span class="o">=</span> <span class="no">NMatrix</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="o">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="o">]</span><span class="p">,</span><span class="o">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="o">]</span><span class="p">,</span>
</span><span class='line'><span class="n">dtype</span><span class="p">:</span> <span class="n">dtype</span><span class="p">)</span>
</span><span class='line'><span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">vt</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">gesvd</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1">#Identical to the above, except for the require</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;nmatrix&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;nmatrix/lapacke&#39;</span>
</span><span class='line'><span class="n">a</span> <span class="o">=</span> <span class="no">NMatrix</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="o">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="o">]</span><span class="p">,</span><span class="o">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="o">]</span><span class="p">,</span>
</span><span class='line'><span class="n">dtype</span><span class="p">:</span> <span class="n">dtype</span><span class="p">)</span>
</span><span class='line'><span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">vt</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">gesvd</span>
</span></code></pre></td></tr></table></div></figure>


<p>If the developer wants to use an advanced feature, but does not care
whether the user is using <code>nmatrix-atlas</code>
or <code>nmatrix-lapacke</code>, they can <code>require nmatrix/lapack_plugin</code>, which will
require whichever of the two is available, instead of being forced to
choose between the two.</p>

<p>As a fun test of the new gems, I did a very simple benchmark, just
testing how long it took to invert a
1500-by-1500 matrix in place using <code>NMatix#invert!</code>:</p>

<ul>
<li><code>nmatrix</code> (no external libraries): 3.67s</li>
<li><code>nmatrix-atlas</code>: 0.96s</li>
<li><code>nmatrix-lapacke</code> with ATLAS: 0.99s</li>
<li><code>nmatrix-lapacke</code> with OpenBLAS (multithreading enabled): 0.39s</li>
<li><code>nmatrix-lapacke</code> with reference implementations of LAPACK and BLAS: 3.72s</li>
</ul>


<p>This is not supposed to be a thorough or realistic benchmark (performance will
depend on your system, on how you built the libraries, and on the exact
functions that you use), but there
are still a few interesting conclusions we can draw from it:</p>

<ul>
<li>Performance is much better using the two highly optimized libraries
(ATLAS and OpenBLAS) than using either the NMatrix
internal implementation or the reference implementation.</li>
<li>When using ATLAS, performance is similar whether using <code>nmatrix-atlas</code>
and <code>nmatrix-lapacke</code> (this means we could consider deprecating
the <code>nmatix-atlas</code> gem).</li>
</ul>


<p>Overall, my summer has been productive. I implemented everything that I
proposed and feedback from testers so far has been positive.
I plan to stay involved with NMatrix, especially to follow up on any issues
related to my changes.
Although I won&#8217;t be a student next summer, I would certainly consider
participating in Google Summer of Code in the future as a mentor.
I&#8217;d like to
thank my mentor John Woods and the rest of the SciRuby community for support
and feedback throughout the summer.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[GnuplotRB and GSoC 2015]]></title>
    <link href="http://SciRuby.github.com/blog/2015/08/18/gnuplotrb-project/"/>
    <updated>2015-08-18T23:26:00-05:00</updated>
    <id>http://SciRuby.github.com/blog/2015/08/18/gnuplotrb-project</id>
    <content type="html"><![CDATA[<h2>Introduction</h2>

<p>This summer I&#8217;ve been participating in Google Summer of Code
 with <a href="https://github.com/dilcom/gnuplotrb">GnuplotRB project</a> (plotting tool for Ruby users based on <a href="http://www.gnuplot.info/">Gnuplot</a>)
 for <a href="http://sciruby.com/">SciRuby</a>. GSoC is almost over and I&#8217;m releasing v0.3.1 of GnuplotRB as a <a href="https://rubygems.org/gems/gnuplotrb/">gem</a>.
 In this blog post I want to introduce the gem and highlight some of its capabilities.</p>

<h2>Features</h2>

<p>There are several existing plotting tools for Ruby such as Nyaplot, Plotrb, Rubyvis
 and Gnuplot gem. However they are not designed for large datasets and have fewer
 plotting styles and options than Gnuplot. Gnuplot gem was developed long ago and nowadays consists
 mostly of hacks and does not support modern Gnuplot features such as multiplot.</p>

<p>Therefore my goal was to develop new gem for Gnuplot which would allow full use of its
 features in Ruby. I was inspired to build an easy-to-use interface for the most commonly
 used features of Gnuplot and allow users to customize their plots with
 Gnuplot options as easily as possible in Rubyesque way.</p>

<!--more-->


<h3>2D and 3D plots</h3>

<p>The main feature of every plotting tool is its ability to plot graphs. GnuplotRB allows you
 to plot both mathematical formula  and (huge) sets of data. GnuplotRB supports plotting
 2D graphs (<code>GnuplotRB::Plot</code> class)  in Cartesian/parametric/polar coordinates and 3D
 graphs (<code>GnuplotRB::Splot</code> class) &mdash; in Cartesian/cylindrical/spherical coordinates.</p>

<p>There are vast of plotting styles supported by GnuplotRB:</p>

<ul>
<li><code>points</code></li>
<li><code>lines</code></li>
<li><code>histograms</code></li>
<li><code>boxerrorbars</code></li>
<li><code>circles</code></li>
<li><code>boxes</code></li>
<li><code>filledcurves</code></li>
<li><code>vectors</code></li>
<li><code>heatmap</code></li>
<li>etc (full list in <a href="http://www.gnuplot.info/docs_5.0/gnuplot.pdf">gnuplot doc</a> p. 47)</li>
</ul>


<p>Plot examples:</p>

<p><img src="http://SciRuby.github.com/images/gnuplotrb-gsoc2015/plots.jpg" alt="Plot example" style="width: 100%;"/></p>

<p>For code examples please see
 <a href="https://github.com/dilcom/gnuplotrb/blob/master/README.rdoc">the repository README</a>,
 <a href="https://github.com/dilcom/gnuplotrb/blob/master/notebooks/README.rdoc">notebooks</a>
 and <a href="https://github.com/dilcom/gnuplotrb/tree/master/examples">the examples folder</a>.</p>

<h3>Multiplot</h3>

<p><code>GnuplotRB::Multiplot</code> allows users to place several plots on a single layout and output
 them at once (e.g., to a PNG file).
 <a href="http://nbviewer.ipython.org/github/dilcom/gnuplotrb/blob/master/notebooks/multiplot_layout.ipynb">Multiplot notebook</a>.</p>

<p>Here is a multiplot example
 (taken from <a href="http://nbviewer.ipython.org/github/SciRuby/sciruby-notebooks/blob/master/Data%20Analysis/Analyzing%20baby%20names/Use%20Case%20-%20Daru%20for%20analyzing%20baby%20names%20data.ipynb">Sameer&#8217;s notebook</a>):</p>

<p><img src="http://SciRuby.github.com/images/gnuplotrb-gsoc2015/multiplot.jpg" alt="Multiplot example" style="width: 80%; align: middle;"/></p>

<h3>Animated plots</h3>

<p>GnuplotRB may output any plot to gif file but <code>GnuplotRB::Animation</code> allows
 to make this gif animated. It takes several <code>Plot</code> or <code>Splot</code> objects just as
 multiplot does and outputs them one-by-one as frames of gif animation.
 <a href="http://nbviewer.ipython.org/github/dilcom/gnuplotrb/blob/master/notebooks/animated_plots.ipynb">Animation notebook</a>.</p>

<p><img src="http://SciRuby.github.com/images/gnuplotrb-gsoc2015/trajectory.gif" alt="Trajectory example" style="width: 80%; align: middle;"/></p>

<h3>Fit</h3>

<p>Although the main GnuplotRB&#8217;s purpose is to provide you with swift, robust and
 easy-to-use plotting tool, it also offers a <code>Fit</code> module that contains several
 methods for fitting given data with a function. See examples in <a href="http://nbviewer.ipython.org/github/dilcom/gnuplotrb/blob/master/notebooks/fitting_data.ipynb">Fit notebook</a>.</p>

<h3>Integration with other SciRuby tools</h3>

<h4>Embedding plots into iRuby notebooks</h4>

<p>GnuplotRB plots may be embedded into iRuby notebooks as JPEG/PNG/SVG
 images, as ASCII art or GIF animations (<code>Animation</code> class). This functionality
 explained in a special <a href="http://nbviewer.ipython.org/github/dilcom/gnuplotrb/blob/master/notebooks/basic_usage.ipynb">iRuby notebook</a>.</p>

<h4>Using data from Daru containers</h4>

<p>To link GnuplotRB with other SciRuby tools I implemented plot
 creation from data given in Daru containers (<code>Daru::Dataframe</code> and <code>Daru::Vector</code>).
 One can use <code>daru</code> gem in order to work with statistical SciRuby gems
 and plotting with GnuplotRB. Notebooks with examples: <a href="http://nbviewer.ipython.org/github/dilcom/gnuplotrb/blob/master/notebooks/plotting_from_daru.ipynb">1</a>, <a href="http://nbviewer.ipython.org/github/dilcom/gnuplotrb/blob/master/notebooks/time_series_from_daru.ipynb">2</a>.</p>

<h3>Possible datasources for plots</h3>

<p>You can pass to Plot (or Splot or Dataset) constructor data in the following forms:</p>

<ul>
<li>String containing mathematical formula (e.g., <code>'sin(x)'</code>)</li>
<li>String containing name of file with data (e.g., <code>'points.data'</code>)</li>
<li>Some Ruby object responding to <code>#to_gnuplot_points</code>

<ul>
<li><code>Array</code></li>
<li><code>Daru::Dataframe</code></li>
<li><code>Daru::Vector</code></li>
</ul>
</li>
</ul>


<p>See examples in <a href="https://github.com/dilcom/gnuplotrb/blob/master/notebooks/README.rdoc#possible-datasources">notebooks</a>.</p>

<h2>Links</h2>

<ul>
<li><a href="https://github.com/dilcom/gnuplotrb/">Project repository</a></li>
<li><a href="https://rubygems.org/gems/gnuplotrb/">Gem page on Rubygems</a></li>
<li><a href="http://www.rubydoc.info/gems/gnuplotrb/0.3.1">Gem documentation on Rubydoc</a></li>
<li><a href="http://dilcom.github.io/gnuplotrb/">Blog of the project</a></li>
<li><a href="https://github.com/dilcom/gnuplotrb/tree/master/examples">Examples</a></li>
<li><a href="https://github.com/dilcom/gnuplotrb/blob/master/notebooks/README.rdoc">iRuby notebooks</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ruby Wrappers for SymEngine, a C++ symbolic manipulation library]]></title>
    <link href="http://SciRuby.github.com/blog/2015/08/17/ruby-wrappers-for-symengine/"/>
    <updated>2015-08-17T14:30:00-05:00</updated>
    <id>http://SciRuby.github.com/blog/2015/08/17/ruby-wrappers-for-symengine</id>
    <content type="html"><![CDATA[<p>I am sure you have heard about <a href="http://www.wolframalpha.com/">Wolfram Alpha</a>. Some of you would have used its <a href="http://www.wolframalpha.com/examples/Math.html">Mathematics section</a> at some point of time to cross check your solution to a maths problem. If you haven&#8217;t, please do. A computer algebra system (CAS) does the same thing. Algebraic computation or symbolic computation are all used interchangeably. A CAS solves problems the same way a human does, but way more quickly and precisely. There is very less chance for an error, that we humans often make.</p>

<h2>Introduction</h2>

<p>My project was to write the Ruby extensions for the library <a href="https://github.com/sympy/symengine">SymEngine</a> and come up with a Ruby-ish interface, after which we can use the features of SymEngine from Ruby.</p>

<p><a href="https://github.com/sympy/symengine">SymEngine</a> is a library for symbolic computation in C++. You may ask, why SymEngine? There are other CASs that I know of. This question was indeed asked. At the beginning, the idea was to use ruby wrappers for <a href="http://www.sagemath.org/">sage</a> (a mathematics software system) which uses <a href="http://pynac.org/">Pynac</a>, an interface to <a href="http://www.ginac.de/">GiNaC</a> (another CAS). As it turns out from the benchmarks, SymEngine is much faster than Pynac. What about directly wrapping GiNaC? SymEngine is also a bit faster than GiNaC.</p>

<p>The motivation for <a href="https://github.com/sympy/symengine">SymEngine</a> itself is to develop it once in C++ and then use it from other languages rather than doing the same thing all over again for each language that it is required in. In particular, a long term goal is to make Sage as well as SymPy use it by default, thus unifying the Python CAS communities. The goal of implementing the Ruby wrappers is to provide a CAS for the Ruby community.</p>

<h3>How will this be useful?</h3>

<p>There are times when we might need a symbolic computation library. Here is an incomplete list of some of the situations:</p>

<ul>
<li>We need to do some algebra to get systems of equations in suitable form for numerical computation.</li>
<li>We need to make substitutions for some variables and don’t want to risk a math error by hand. There might be times when we want to partially simplify an expression by substituting only a few of its variables.</li>
<li>We have a situation where we need to find the optimum number of something to maximise our profits, and the mathematical model devised is just too complicated to solve by hand.</li>
<li>We need to perform non-trivial derivatives or integrals.</li>
<li>We are trying to understand the domain of a new function.</li>
<li>Most root finding algorithms search for a single root, whereas often there are more than one.</li>
<li>We need to solve a linear system or manipulate a symbolic matrix exactly.</li>
<li>We need to manipulate exact expressions and solutions, as opposed to approximate ones using a numerical method.</li>
</ul>


<p>With that said, a symbolic manipulation library is indispensable for scientists and students. Ruby has gained a great deal of popularity over the years, and a symbolic manipulation library gem  like this project in Ruby might prove to be the foundation for a computer algebra system in Ruby. With many efforts like these, Ruby might become the first choice for academicians given how easy it is to code your logic in Ruby.</p>

<h2>How to install the gem?</h2>

<p>To install, please follow the <a href="https://github.com/sympy/symengine/blob/master/symengine/ruby/README.md">compile instructions given in the README</a>. After you are done, I would suggest to test the extensions. To run the test suite execute <code>rspec spec</code> on the command line, from the <code>symengine/ruby</code> dir.</p>

<p>The gem is still in alpha release. Please help us out by reporting any issues in <a href="https://github.com/sympy/symengine/issues">the repo issue tracker</a>.</p>

<h2>What can I do with the gem?</h2>

<p>Currently, the following features are available in the gem:
- Construct expressions out of variables (mathematical).
- Simplify the expressions.
- Carry out arithmetic operations like <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>**</code> with the variables and expressions.
- Extract arguments or variables from an expression.
- Differentiate an expression with respect to another.
- Substitute variables with other expressions.</p>

<p>Features that will soon be ported to the SymEngine gem
- Functions, including trigonometric, hyperbolic and some special functions.
- Matrices, and their operations.
- Basic number-theoretic functions.</p>

<p>I have developed a <a href="https://github.com/sympy/symengine/tree/master/symengine/ruby/notebooks">few IRuby notebooks</a> that demonstrate the use of the new SymEngine module in ruby.</p>

<p>Below is an example taken from the notebooks.</p>

<hr />

<h2>Using the SymEngine Gem</h2>

<p>SymEngine is a module in the extensions, and the classes are a part of it. So first you fire up the interpreter or an IRuby notebook and load the file:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;symengine&#39;</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="kp">true</span>
</span></code></pre></td></tr></table></div></figure>


<p>Go ahead and try a function:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">SymEngine</span><span class="o">.</span><span class="n">ascii_art</span>
</span><span class='line'><span class="o">=&gt;</span>   <span class="n">_____</span>           <span class="n">_____</span>         <span class="n">_</span>
</span><span class='line'>    <span class="o">|</span>   <span class="n">__</span><span class="o">|</span><span class="n">_</span> <span class="n">_</span> <span class="n">_____</span><span class="o">|</span>   <span class="n">__</span><span class="o">|</span><span class="n">___</span> <span class="n">___</span><span class="o">|</span><span class="n">_</span><span class="o">|</span><span class="n">___</span> <span class="n">___</span>
</span><span class='line'>    <span class="o">|</span><span class="n">__</span>   <span class="o">|</span> <span class="o">|</span> <span class="o">|</span>     <span class="o">|</span>   <span class="n">__</span><span class="o">|</span>   <span class="o">|</span> <span class="o">.</span> <span class="o">|</span> <span class="o">|</span>   <span class="o">|</span> <span class="o">-</span><span class="n">_</span><span class="o">|</span>
</span><span class='line'>    <span class="o">|</span><span class="n">_____</span><span class="o">|</span><span class="n">_</span>  <span class="o">|</span><span class="n">_</span><span class="o">|</span><span class="n">_</span><span class="o">|</span><span class="n">_</span><span class="o">|</span><span class="n">_____</span><span class="o">|</span><span class="n">_</span><span class="o">|</span><span class="n">_</span><span class="o">|</span><span class="n">_</span>  <span class="o">|</span><span class="n">_</span><span class="o">|</span><span class="n">_</span><span class="o">|</span><span class="n">_</span><span class="o">|</span><span class="n">___</span><span class="o">|</span>
</span><span class='line'>          <span class="o">|</span><span class="n">___</span><span class="o">|</span>               <span class="o">|</span><span class="n">___</span><span class="o">|</span>
</span></code></pre></td></tr></table></div></figure>


<p>or create a variable:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">basic</span> <span class="o">=</span> <span class="no">SymEngine</span><span class="o">::</span><span class="no">Basic</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="c1">#&lt;SymEngine::Basic:0x00000001e95290&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>This shows that we have successfully loaded the module.</p>

<h3>SymEngine::Symbol</h3>

<p>Just like there are variables like x, y, and z in a mathematical expression or equation, we have <code>SymEngine::Symbol</code> in SymEngine to represent them. To use a variable, first we need to make a <code>SymEngine::Symbol</code> object with the string we are going to represent the variable with.:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">puts</span> <span class="n">x</span> <span class="o">=</span> <span class="no">SymEngine</span><span class="o">::</span><span class="no">Symbol</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
</span><span class='line'><span class="nb">puts</span> <span class="n">y</span> <span class="o">=</span> <span class="no">SymEngine</span><span class="o">::</span><span class="no">Symbol</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
</span><span class='line'><span class="nb">puts</span> <span class="n">z</span> <span class="o">=</span> <span class="no">SymEngine</span><span class="o">::</span><span class="no">Symbol</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">x</span>
</span><span class='line'><span class="n">y</span>
</span><span class='line'><span class="n">z</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then we can construct expressions out of them:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">e</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">y</span><span class="o">/</span><span class="n">z</span><span class="p">)</span>
</span><span class='line'><span class="n">e</span><span class="o">.</span><span class="n">to_s</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="s2">&quot;x**y*(x - y)/z&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>In SymEngine, every object is an instance of Basic or its subclasses. So, even an instance of <code>SymEngine::Symbol</code> is a Basic object.:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">x</span><span class="o">.</span><span class="n">class</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="no">SymEngine</span><span class="o">::</span><span class="no">Symbol</span>
</span><span class='line'>
</span><span class='line'><span class="n">x</span><span class="o">.</span><span class="n">is_a?</span> <span class="no">SymEngine</span><span class="o">::</span><span class="no">Basic</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="kp">true</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now that we have an expression, we would like to see it&#8217;s expanded form using <code>#expand</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">f</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
</span><span class='line'><span class="n">f</span><span class="o">.</span><span class="n">to_s</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="s2">&quot;x**(1 + y)/z - x**y*y/z&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Or check if two expressions are same:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">f</span> <span class="o">==</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">y</span><span class="o">*</span><span class="n">y</span><span class="o">/</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">y</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="n">z</span><span class="p">)</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="kp">true</span>
</span></code></pre></td></tr></table></div></figure>


<p>But <code>e</code> and <code>f</code> are not equal since they are only mathematically equal, not structurally:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">e</span> <span class="o">==</span> <span class="n">f</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="kp">false</span>
</span></code></pre></td></tr></table></div></figure>


<p>Let us suppose you want to know <strong>what variables/symbols your expression has</strong>. You can do that with the <code>#free_symbols</code> method, which returns a set of the symbols that are in the expression.:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">f</span><span class="o">.</span><span class="n">free_symbols</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="c1">#&lt;Set: {#&lt;SymEngine::Basic:0x00000001f0ca70&gt;, #&lt;SymEngine::Basic:0x00000001f0ca48&gt;, #&lt;SymEngine::Basic:0x00000001f0ca20&gt;}&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Let us use <code>#map</code> method to see the elements of the <code>Set</code>.:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">f</span><span class="o">.</span><span class="n">free_symbols</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">x</span><span class="o">|</span> <span class="n">x</span><span class="o">.</span><span class="n">to_s</span> <span class="p">}</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="o">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>#args</code> returns the terms of the expression,:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">f</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">x</span><span class="o">|</span> <span class="n">x</span><span class="o">.</span><span class="n">to_s</span> <span class="p">}</span>
</span><span class='line'><span class="o">[</span><span class="s2">&quot;-x**y*y/z&quot;</span><span class="p">,</span> <span class="s2">&quot;x**(1 + y)/z&quot;</span><span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>or if it is a single term it breaks down the elements:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">f</span><span class="o">.</span><span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="n">args</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">k</span><span class="o">|</span> <span class="n">k</span><span class="o">.</span><span class="n">to_s</span> <span class="p">}</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="o">[</span><span class="s2">&quot;-1&quot;</span><span class="p">,</span> <span class="s2">&quot;x**y&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z**(-1)&quot;</span><span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<h3>SymEngine::Integer</h3>

<p>You can make objects of class <code>SymEngine::Integer</code>. It&#8217;s like regular <code>Integer</code> in ruby kernel, except it can do all the operations a <code>Basic</code> object can &mdash; such as arithmetic operations, etc.:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">a</span> <span class="o">=</span> <span class="no">SymEngine</span><span class="o">::</span><span class="nb">Integer</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
</span><span class='line'><span class="n">b</span> <span class="o">=</span> <span class="no">SymEngine</span><span class="o">::</span><span class="nb">Integer</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span>
</span><span class='line'><span class="n">a</span><span class="o">**</span><span class="n">b</span>
</span><span class='line'>
</span><span class='line'><span class="o">=&gt;</span> <span class="mi">1168422057627266461843148138873451659428421700563161428957815831003136</span>
</span></code></pre></td></tr></table></div></figure>


<p>Additionally, it can support numbers of arbitrarily large length.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">to_s</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="s2">&quot;12**x&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>SymEngine::Rational</h3>

<p>You can also make objects of class <code>SymEngine::Rational</code> which is the SymEngine counterpart for <code>Rationals</code> in Ruby.:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">c</span> <span class="o">=</span> <span class="no">Rational</span><span class="p">(</span><span class="s1">&#39;2/3&#39;</span><span class="p">)</span>
</span><span class='line'><span class="n">d</span> <span class="o">=</span> <span class="no">SymEngine</span><span class="o">::</span><span class="no">Rational</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="o">=&gt;</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span>
</span></code></pre></td></tr></table></div></figure>


<p>Like any other <code>Basic</code> object arithmetic operations can be done on this rational type too.:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">to_s</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="s2">&quot;34/3&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<hr />

<p>You <strong>need not create</strong> an instance of <code>SymEngine::Integer</code> or <code>SymEngine::Rational</code>, every time you want to use them in an expression that uses many <code>Integer</code>s. Let us say you already have <code>Integer</code>/<code>Rational</code> object. Even then you can use them without having to create a new <code>SymEngine</code> object.:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span> <span class="c1"># c is a Rational object, not SymEngine::Rational</span>
</span><span class='line'><span class="n">k</span><span class="o">.</span><span class="n">to_s</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="s2">&quot;(2/3 + x*y)*(2 + 1/(x*y) - x*y)&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>As you can see, ruby kernel <code>Integer</code>s and <code>Rational</code>s interoperate seamlessly with the <code>SymEngine</code> objects.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">k</span><span class="o">.</span><span class="n">expand</span><span class="o">.</span><span class="n">to_s</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="s2">&quot;7/3 + (2/3)*1/(x*y) + (4/3)*x*y - x**2*y**2&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<hr />

<h2>What I learned</h2>

<p>In the rest of the post, I would like to summarise my work and what I learned as a participant of <a href="https://www.google-melange.com/gsoc/homepage/google/gsoc2015">Google Summer of Code 2015</a>.</p>

<h2>Pre-midterm Evaluations</h2>

<p>I am a newbie when it comes to Ruby, and it took me a while to setup the gem and configure files for the building of extensions.</p>

<h3>The struggle between shared, static and dynamic libraries</h3>

<p>I faced a lot of problem in the early stages, when I was trying to build the extensions. <a href="https://github.com/certik">Ondrej</a>, my mentor, and <a href="https://github.com/isuruf">Isuru</a>, a fellow GSoC student, helped me a lot. There were many C flags that were being reported as missing. Some flags <code>cmake</code> added by default but <code>extconf.rb</code> didn&#8217;t, the same one that was required to be added to build it as a shared library. I am still confused about the details, some of which are <a href="http://abinashmeher999.github.io/2015/05/29/Building-the-wrappers/">explored in greater detail in my personal blog</a>. Finally, the library had to be built as a dynamic one. The problem of missing C flags was resolved later by hooking the process to <code>cmake</code> rather than <code>mkmf</code>.</p>

<h3>Load Errors and problems in linking</h3>

<p>Many <a href="http://abinashmeher999.github.io/2015/06/12/The-Load-Error/"><code>LoadError</code>s</a> popped up, but were eventually solved. <a href="https://github.com/dilcom/">Ivan</a> helped a lot in debugging the errors. In the end, it turned out to be a simple file missing in the gemspec, that was not being installed.</p>

<h3>Reconfiguring building</h3>

<p>One of our aims during developing this was to get rid of unessential dependencies. The ones we already had the tools for. Like later the file <code>extconf.rb</code>, that is used to generate Makefile for the extension was removed, because that could also be done by <code>cmake</code>. Flags were added to <code>cmake</code> for building the Ruby extensions, like the flag <code>-DWITH_RUBY=yes</code>. The <code>Makefile</code> then generates the library <code>symengine.so</code> in the directory <code>lib/symengine</code>.Along with <code>extconf.rb</code>, the file <code>extconf.h</code> was also gone. Along these lines, the dependency on <code>rake</code> was also removed, and with that the <code>Rakefile</code>. Any task automation will most probably be done in python. So, the <code>Rake::ExtensionTask</code> was done by <code>cmake</code> and the <code>Rake::GemPackageTask</code> was replaced by the manual method of <code>gem build symengine.gemspec</code> and <code>gem install symengine-0.0.0.gem</code></p>

<h3>Travis setup</h3>

<p>Not many projects have travis-ci setup for multiple languages. Not even the tutorials had clearly mentioned about setting up for multiple languages. But I did know about one of them, which is Shogun, the machine-learning toolbox. I referred to their <code>.travis.yml</code> and setup it up. If something like this wouldn&#8217;t have worked the plan was to manually install the required version of ruby and then execute the shell commands.</p>

<h3>Making a basic object</h3>

<p>Finally, I was able to successfully build the extensions, link the extensions with the SymEngine library, load the ruby-extension library in the interpreter and successfully instantiate an object of type <code>Basic</code>.</p>

<h3>Inheritance and Symbols</h3>

<p>At this time, the way inheritance works(like the sequence of formation and destruction of objects of a class that had a superclass) with the Ruby C API, was confusing for all of us. I designed an <a href="http://abinashmeher999.github.io/2015/06/26/the-symbol-class/#inheritance-in-ruby-c-api">experiment</a>
to check what was actually happening. That cleared things out, and made the it easier to wrap things from now on. I also wrapped the <code>Symbol</code> class during the course.</p>

<h2>Post-midterm Evaluations</h2>

<h3>Redesign of the C interface</h3>

<p>We had to design an ugly function to wrap vector in C. That led us to redesign the C interface. This approach had no reinterpret casting that was being done earlier. Each data structure had a type that was determined at compile time. For C, it was an opaque structure, while for C++ the opaque structure declared in the shared header file was implemented in the source file that had C++ data types. This <a href="http://abinashmeher999.github.io/2015/07/03/improving-the-c-interface/">blog post</a> explains it further.</p>

<h3>Integer and Rational</h3>

<p>While trying to port the SymEngine classes, <code>Integer</code> and <code>Rational</code>, I had to port many methods in <code>Basic</code> before that. I also replicated the <code>rake</code> tasks in NMatrix, for detection of memory leaks, in form of bash scripts.</p>

<h3>Common enumeration</h3>

<p>Since all objects in the Ruby C API are of the type <code>CBasic</code>, we needed a function that would give us the typename during the runtime for the corresponding objects to be wrapped in ruby, as an object of the correct <code>Class</code> in ruby. Since, this was achieved with <code>enum</code> in C++, the same thing could be done in C too, with all the classes written manually again. But there was no guarantee for this to be consistent, if ever the features required to be wrapped for a new language, and also manually adding the class in all the enum list everytime a new class is added was prone to errors. So, to make this DRY, we automated this by sharing the list of enums. More details for the implementation can be found <a href="http://abinashmeher999.github.io/2015/07/17/common-enumeration-in-c-and-c++/">here</a>.</p>

<h3>Class coercion and interoperability</h3>

<p>To support interoperability with the builtin ruby types, I had to overload the methods in builtin classes earlier(this was not continued). Overriding all the existing binary operations for a ruby class to support SymEngine types, violated the open/closed principle. There was indeed another way, which is <em>&#8216;Class Coercion&#8217;</em>. It was suggested by <a href="https://github.com/isuruf/">Isuru</a>. After that, SymEngine types could seamlessly interoperate between the ruby types.</p>

<h3>Arithmetic operations</h3>

<p>After this, all the arithmetic operations had been successfully ported. Each <code>Basic</code> object can now perform arithmetic operations with other <code>Basic</code> object(sometimes even ruby objects like <code>Integer</code>). The test file in python, that had all the corresponding test cases was ported to its RSpec counterpart.</p>

<h3>Substitutions</h3>

<p>Recently I completed porting the substitutions module to the extensions(<code>#subs</code>). This feature has added a lot of convenience as now you can substitute a <code>SymEngine::Symbol</code> with some other value in an expression and then <code>#expand</code> to get the result.</p>

<h3>Trigonometric functions</h3>

<p>Currently, I am working on porting the trigonometric functions in SymEngine to the extensions. This would first require to wrap the <code>Function</code> class and then the <code>TrigFunction</code> class in SymEngine.</p>

<h3>Integration of other Ruby gems</h3>

<p>I also have plans to integrate the ruby bindings for <code>gmp</code>, <code>mpfr</code> and <code>mpc</code> libraries, that are already available as gems, with ruby bindings for our library. I have created an issue <a href="https://github.com/sympy/symengine/issues/490">here</a>. Feel free to drop any suggestions.</p>

<hr />

<p>There is much scope for improvement in both the projects. For SymEngine, to support more features like polynomials and series-expansion in the near future, and improving the user interface and the exception handling for the extensions. In short, making the extensions more ruby-ish.</p>

<p>I am grateful to my mentor, <a href="https://github.com/certik">Mr. Ondřej Čertík</a>, the <a href="http://sciruby.com/">Ruby Science Foundation</a> and the <a href="http://www.sympy.org/en/index.html">SymPy Organisation</a> for the opportunity that they gave me and guiding me through the project, and my team-mates for helping me with the issues. I hope more people will contribute to the project and together we will give a nice symbolic manipulation gem to the Ruby community.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Summary of work on daru this summer for GSOC 2015]]></title>
    <link href="http://SciRuby.github.com/blog/2015/08/16/summary-of-work-on-daru-this-summer-for-gsoc-2015/"/>
    <updated>2015-08-16T23:53:00-05:00</updated>
    <id>http://SciRuby.github.com/blog/2015/08/16/summary-of-work-on-daru-this-summer-for-gsoc-2015</id>
    <content type="html"><![CDATA[<p>Over this summer as a part of <a href="www.google-melange.com">Google Summer of Code 2015</a>, <a href="www.github.com/v0dro/daru/">daru</a> received a lot of upgrades and new features which have it made a pretty robust tool for data analysis in pure Ruby. Of course, a lot of work still remains for bringing daru at par with the other data analysis solutions on offer today, but I feel the work done this summer has put daru on that path.</p>

<p>The new features led to the inclusion of daru in many of SciRuby&#8217;s gems, which use daru&#8217;s data storage, access and indexing features for storing and carrying around data. <a href="https://github.com/SciRuby/statsample">Statsample</a>, <a href="https://github.com/SciRuby/statsample-glm">statsample-glm</a>, <a href="https://github.com/SciRuby/statsample-timeseries">statsample-timeseries</a>, <a href="https://github.com/SciRuby/statsample-bivariate-extension">statsample-bivariate-extensions</a> are all now compatible with daru and use <code>Daru::Vector</code> and <code>Daru::DataFrame</code> as their primary data structures. I also overhauled Daru&#8217;s <a href="http://nbviewer.ipython.org/github/SciRuby/sciruby-notebooks/blob/master/Visualization/Visualizing%20data%20with%20daru%20DataFrame.ipynb">plotting functionality</a>, that interfaced with <a href="https://github.com/domitry/nyaplot">nyaplot</a> for creating interactive plots directly from the data.</p>

<p>Also, new gems developed by other GSOC students, notably <a href="https://github.com/dilcom/gnuplotrb">Ivan&#8217;s GnuplotRB gem</a> and <a href="https://github.com/agisga/mixed_models">Alexej&#8217;s mixed_models gem</a> both now accept data from daru data structures. Do see their repo pages for seeing interesting ways of using daru.</p>

<p>The work on daru is also proving to be quite useful for other people, which led to a talk/presentation at <a href="http://www.deccanrubyconf.org/">DeccanRubyConf 2015</a>, which is one of the three major Ruby conferences in India. You can see the slides and notebooks presented at the talk <a href="https://github.com/v0dro/talks/tree/master/DeccanRubyConf15">here</a>. Given the current interest in data analysis and the need for a viable solution in Ruby, I plan to take daru much further. Keep watching the repo for interesting updates :)</p>

<p>In the rest of this post I&#8217;ll elaborate on all the work done this summer.</p>

<h2>Pre-mid term submissions</h2>

<p>Daru as a gem before GSOC was not exactly user friendly. There were many cases, particularly the iterators, that required some thinking before anybody used them. This is against the design philosophy of daru, or even Ruby general, where surprising programmers with ubiqtuos constructs is usually frowned down upon by the community. So the first thing that I did mainly concerned overhauling the daru&#8217;s many iterators for both <code>Vector</code> and <code>DataFrame</code>.</p>

<p>For example, the <code>#map</code> iterator from <code>Enumerable</code> returns an <code>Array</code> no matter object you call it on. This was not the case before, where <code>#map</code> would a <code>Daru::Vector</code> or <code>Daru::DataFrame</code>. This behaviour was changed, and now <code>#map</code> returns an <code>Array</code>. If you want a <code>Vector</code> or a <code>DataFrame</code> of the modified values, you should call <code>#recode</code> on <code>Vector</code> or <code>DataFrame</code>.</p>

<p>Each of these iterators also accepts an optional argument, <code>:row</code> or <code>:vector</code>, which will define the axis over which iteration is supposed to be carried out. So now there are the <code>#each</code>, <code>#map</code>, <code>#map!</code>, <code>#recode</code>, <code>#recode!</code>, <code>#collect</code>, <code>#collect_matrix</code>, <code>#all?</code>, <code>#any?</code>, <code>#keep_vector_if</code> and <code>#keep_row_if</code>. To iterate over elements along with their respective indexes (or labels), you can likewise use <code>#each_row_with_index</code>, <code>#each_vector_with_index</code>, <code>#map_rows_with_index</code>, <code>#map_vector_with_index</code>, <code>#collect_rows_with_index</code>, <code>#collect_vector_with_index</code> or <code>#each_index</code>. I urge you to go over the docs of each of these methods to utilize the full power of daru.</p>

<p>Apart from the improvements to iterators there was also quite a bit of refactoring involved for many methods (courtesy <a href="https://github.com/agisga">Alexej</a>). The refactoring of certain core methods has made daru much faster than previous versions.</p>

<p>The next (major) thing to do was making daru compatible with Statsample. This was very essential since statsample is very important tool for statistics in Ruby and it was using its own <code>Vector</code> and <code>Dataset</code> classes, which weren&#8217;t very robust as computation tools and very difficult to use when it came to cleaning or munging data. So I replaced statsample&#8217;s Vector and Dataset clases with <code>Daru::Vector</code> and <code>Daru::DataFrame</code>. It involved a significant amount of work on both statsample and daru &mdash; Statsample because many constructs had to be changed to make them compatible with daru, and daru because there was a lot of essential functionality in these classes that had to be ported to daru.</p>

<p>Porting code from statsample to daru improved daru significantly. There were a whole of statistics methods in statsample that were imported into daru and you can now use all them from daru. Statsample also works well with <a href="https://github.com/clbustos/rubyvis">rubyvis</a>, a great tool for visualization. <a href="https://github.com/SciRuby/statsample#visualizations">You can now do that with daru as well</a>.</p>

<p>Many new methods for reading and writing data to and from files were also added to daru. You can now read and write data to and from CSV, Excel, plain text files or even SQL databases.</p>

<p>In effect, daru is now completely compatible with Statsample (and all the other Statsample extensions). You can use daru data structures for storing data and pass them to statsample for performing computations. The biggest advantage of this approach is that the analysed data can be passed around to other scientific Ruby libraries (some of which listed above) that use daru as well. Since daru offers in-built functions to better &#8216;see&#8217; your data, better visualization is possible.</p>

<p>See these <a href="https://github.com/v0dro/daru#blog-posts">blogs</a> and <a href="https://github.com/v0dro/daru#notebooks">notebooks</a> for a complete overview of daru&#8217;s new features.</p>

<p>Also see the <a href="https://github.com/SciRuby/statsample#notebooks">notebooks in the statsample README</a> for using daru with statsample.</p>

<h2>Post-mid term submissions</h2>

<p>Most of time post the mid term submissions was spent in implementing the time series functions for daru.</p>

<p>I implemented a new index, the DateTimeIndex, which can used for indexing data on time stamps. It enables users to query data based on time stamps. Time stamps can either be specified with precise Ruby DateTime objects or can be specified as strings, which will lead to retrival of all the data falling under that time. For example specifying &#8216;2012&#8217; returns all data that falls in the year 2012. See detailed usage of <code>DateTimeIndex</code> and <code>DateTime</code> in conjunction with other daru constructs <a href="https://github.com/v0dro/daru/blob/master/README.md">in the daru README</a>.</p>

<p>An essential utility in implementing <code>DateTimeIndex</code> was <code>DateOffset</code>, which is a new set of classes that offsets dates based on certain rules or business logic. It can advance or lag a Ruby <code>DateTime</code> to the nearest day, or any day of the week, or the end or beginning of the month, etc. <code>DateOffset</code> is an essential part of <code>DateTimeIndex</code> and can also be used as a stand-alone utility for advancing/lagging <code>DateTime</code> objects. <a href="http://v0dro.github.io/blog/2015/07/27/date-offsets-in-daru/">This blog post</a> elaborates more on the nuances of <code>DateOffset</code> and its usage.</p>

<p>The last thing done during the post mid term was complete compatibility with <a href="https://github.com/AnkurGel">Ankur Goel</a>&#8217;s <a href="https://github.com/SciRuby/statsample-timeseries">statsample-timeseries</a>, which was created by  during GSOC 2013. Statsample-timeseries is a comprehensive suite offering various functions for statistical analysis of time sries data. It now works with daru containers and can be used for statistical analysis of data indexed on <code>Daru::DateTimeIndex</code>. See some use cases <a href="https://github.com/SciRuby/statsample-timeseries/blob/master/README.rdoc">in the README</a>.</p>

<p>I&#8217;d like to conclude by thanking all the people directly and indirectly involved in making this project a success - My mentor <a href="https://github.com/agarie">Carlos</a> for his help and support throughout the summer, <a href="https://github.com/dilcom">Ivan</a>, <a href="https://github.com/agisga">Alexej</a> and <a href="https://github.com/wlevine">Will</a> for their support and feedback in various stages of developing daru. Also a big thank you to all the <a href="https://github.com/orgs/SciRuby/teams">SciRuby maintainers</a> for making this happen!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[NMatrix's first beta release (belated announcement)]]></title>
    <link href="http://SciRuby.github.com/blog/2015/02/14/nmatrix-beta-released-belated-announcement/"/>
    <updated>2015-02-14T14:56:00-06:00</updated>
    <id>http://SciRuby.github.com/blog/2015/02/14/nmatrix-beta-released-belated-announcement</id>
    <content type="html"><![CDATA[<p>Almost two months ago, in December, we <a href="https://rubygems.org/gems/nmatrix">release our first beta of NMatrix</a>, our
linear algebra library for the Ruby language.</p>

<p>Rather than discussing what NMatrix has (which you can find in the <a href="https://github.com/SciRuby/nmatrix/blob/master/README.rdoc">readme</a>),
I want to take this opportunity to discuss where we&#8217;d like it to go in the future. Think of this as our roadmap to 1.0.</p>

<h2>External Library Requirements</h2>

<p>NMatrix currently has an extremely limited set of Ruby gem dependencies &mdash; essentially only packable, which is
needed for some of the I/O functionality &mdash; but as with other linear algebra libraries, its native library
requirements can be problematic.</p>

<p>Specifically, NMatrix requires ATLAS &mdash; which is virtually impossible to install on many Macs, and is no longer
readily available with Yosemite &mdash; and also likes to have LAPACK around. Moreover, some would prefer to use other
math libraries with NMatrix.</p>

<p>There are several partial solutions. The clearest is that any components of NMatrix which require external non-standard
libraries need to be abstracted into separate gems &mdash; such as <tt>nmatrix-atlas</tt> and <tt>nmatrix-io</tt> &mdash; and
that these components should be interchangeable with others. NMatrix then needs to be able to fall back on either native
C/C++ or Ruby implementations of certain functionalities.</p>

<p>To this end, a number of simple LAPACK and CBLAS functions have been implemented in NMatrix, with volunteers working on
a few others (the list is available in the README). <a href="https://github.com/SciRuby/sciruby/wiki/Google-Summer-of-Code-2015-Ideas#abstraction-of-atlascblasclapack-or-openblas-into-a-separate-gem">One of our proposed Google Summer of Code 2015 project ideas</a> involves
breaking up NMatrix into several gems.</p>

<p>The end result will be a much simpler installation process, and more freedom of choice.</p>

<h2>Removal of Unnecessary Features</h2>

<p>We thought it would be quite clever to include rational number support in NMatrix, including three types (32-bit, 64-bit,
and 128-bit). Unfortunately, these types increase compilation time by about 30% (back-of-the-envelope calculation), and
aren&#8217;t particularly useful since most matrix operations with rationals as inputs give irrational-valued matrices
as their outputs. The inclusion of rational types also complicates the codebase.</p>

<p>Additionally, rationals are computationally problematic; what happens if there is overflow? Ruby handles overflow gracefully
in its own rational type, which NMatrix users would still be able to utilize via the <tt>:object</tt> dtype.</p>

<h2>You</h2>

<p>The biggest change going forward is that NMatrix development needs to support actual use-cases. In the past, we&#8217;ve aimed
to flesh out support for sparse storage formats, as well as math operations for the dense storage-type. It is folly to
develop features no one wants to use. Future core development, then, will aim to make NMatrix&#8217;s current feature set more
usable.</p>

<p>That means that future non-core development depends on you. What would you like to see in NMatrix? What would make it
more useful for you?</p>

<p>If you want to become involved, now is a good time. We&#8217;re getting ready to submit a Google Summer of Code application
(our third, I believe), and we&#8217;re in need of students &mdash; <em>and especially mentors</em>. Please consider joining
our <a href="https://groups.google.com/forum/#!forum/sciruby-dev">mailing list</a> and adding yourself as a mentor on the
<a href="https://github.com/SciRuby/sciruby/wiki/Google-Summer-of-Code-2015-Ideas">ideas page</a>.</p>

<p>Thanks so much for your support!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Nyaplot: interactive plots generator with Ruby]]></title>
    <link href="http://SciRuby.github.com/blog/2014/08/23/nyaplot-interactive-plots-generateor-with-ruby/"/>
    <updated>2014-08-23T10:07:00-05:00</updated>
    <id>http://SciRuby.github.com/blog/2014/08/23/nyaplot-interactive-plots-generateor-with-ruby</id>
    <content type="html"><![CDATA[<iframe width="853" height="480" src="http://SciRuby.github.com//www.youtube.com/embed/ZxjqsIluM88" frameborder="0" allowfullscreen></iframe>


<h2>Introduction</h2>

<p>Three months of GSoC 2014 term was over this week and finally I
released my product <a href="http://rubygems.org/gems/nyaplot">Nyaplot as a gem</a>.
This blog post was written to introduce Nyaplot version 0.1.1.</p>

<h2>Features</h2>

<p>There are various plotting libraries in the world as ggplot2 from R
community and <a href="https://github.com/zuhao/plotrb">Plotrb</a> and
<a href="https://github.com/clbustos/rubyvis">Rubyvis</a> from Ruby.  The
features of Nyaplot compared with those libraries are
<strong>interactivity</strong>, <strong>simplicity</strong>, and <strong>extensibility</strong>.</p>

<p>Interactivity is the main theme of my D3 project in GSoC 2014. You can
soon find the aforementioned interactivity by clicking plots with your
mouse or trackpad. This feature is also available on browsers bundled
with Android or iOS thanks to technologies like SVG and WebGL.</p>

<p>However, the word &#8216;interactivity&#8217; is not limited to situations like
the above. You can explore that for yourself by using Nyaplot in <a href="https://github.com/minad/iruby">IRuby notebook</a>. Various
modules prepared
by Nyaplot help you to create plots interactively in the notebook.
You can also publish the result quickly by uploading the notebook to
your Dropbox storage, a gist or pastebin, or somewhere else. <a href="http://nbviewer.ipython.org/gist/mgiraldo/a68b53175ce5892531bc">Here is an example</a>
which Mauricio Giraldo created and published on gist.</p>

<p>Simplicity is also an important element.  Many plotting libraries has
MATLAB-like function-based API but Nyaplot does not.  Nyaplot is
designed in a more Ruby-like object-oriented style, and its plots
consist of various objects created from different classes. But Nyaplot
has simple shortcut methods and users may avoid the more complex API.</p>

<p><img src="https://dl.dropboxusercontent.com/u/47978121/gsoc/extensions_for_blog_post.png" alt="Extension libraries" /></p>

<p>Nyaplot can be easily and dramatically extended with some JavaScript
code. It bundles 3 extension libraries in its gem package: Nyaplot3D
for 3D plots, Mapnya for map visualization, and Bionya for circular
plots inspired by circos. Their structure is very simple and you can
write the extension easily if you have a little experience in
JavaScript and Ruby. For example, the Ruby part of Bionya has only
about a hundred lines, even though the graphic&#8217;s style is far from
that of standard plots.</p>

<h2>Quick start</h2>

<p>You can install Nyaplot by simply running <code>gem install nyaplot</code>.
After that, find example code from
<code>path_to_gems/nyaplot-0.1.1/examples/rb</code> and run some of them using
<code>ruby</code> command.  These scripts will generate some plots with Nyaplot
and export them as html files to current directory.</p>

<p>In addition, I strongly recommend you to install <a href="https://github.com/minad/iruby">IRuby notebook</a> at
the same time. IRuby is a
web-based, interactive Ruby environment and is useful for quickly
creating plots with Nyaplot. The introduction video embedded at the
top of this post was also created on IRuby.</p>

<p>IRuby depends on some software outside of Ruby-ecosystem, so its
installation method is a bit complicated. Please read <a href="https://github.com/domitry/nyaplot#install-iruby-notebook">the description in the readme</a>
to learn more.</p>

<h2>Usage</h2>

<p>I already wrote tutorials, so I&#8217;d like to limit the role of this
paragraph to the introduction of the basic usage. You can skip
reading this paragraph and find details in <a href="http://nbviewer.ipython.org/github/domitry/nyaplot/blob/master/examples/notebook/Index.ipynb">the nbviewer tutorial</a>
and <a href="http://rubydoc.info/gems/nyaplot/0.1.1/frames">documentation</a>.</p>

<p>The minimum code to create a scatter plot is as shown below:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">plot</span> <span class="o">=</span> <span class="no">Nyaplot</span><span class="o">::</span><span class="no">Plot</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'><span class="n">sc</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="ss">:scatter</span><span class="p">,</span> <span class="o">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">]</span><span class="p">,</span> <span class="o">[-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="o">]</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>Nyaplot::Plot</code> is the base class to create plots and
<code>Nyaplot::Plot#add</code> is the method to add diagram to its instance.  The
first argument is to specify the type of diagram, and the second and
third are for data mapped into <em>x</em> and <em>y</em> axes.  <code>Plot#add</code> returns an
instance of <code>Nyaplot::Diagram</code> and you can change attributes like
color and stroke of each diagram component.</p>

<p>For example you can change its color by running the code below.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">color</span> <span class="o">=</span> <span class="no">Nyaplot</span><span class="o">::</span><span class="no">Colors</span><span class="o">.</span><span class="n">qual</span>
</span><span class='line'><span class="n">sc</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>Nyaplot::Colors</code> is the simple wrapper for
<a href="http://colorbrewer2.org">Colorbrewer</a>, and one of its methods
<code>Nyaplot::Colors.qual</code> randomly returns colorset suitable for
qualitative data.</p>

<p>If you execute this code in IRuby notebook, you can check if you favor
the colorset through html-table based interface. <a href="http://nbviewer.ipython.org/github/domitry/nyaplot/blob/master/examples/notebook/Colors.ipynb">See the tutorial to learn more.</a></p>

<p><img src="https://dl.dropboxusercontent.com/u/47978121/gsoc/colors.png" alt="Nyaplot::Colors" /></p>

<p>The plot generated from the code can be exported with two lines below.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">plot</span><span class="o">.</span><span class="n">show</span> <span class="c1"># show plot on IRuby notebook</span>
</span><span class='line'><span class="n">plot</span><span class="o">.</span><span class="n">export_html</span> <span class="c1"># export plot to the current directory as a html file</span>
</span></code></pre></td></tr></table></div></figure>


<p>We cannot explain Nyaplot without <code>Nyaplot::DataFrame</code>. Example code
above does not contain the word &#8216;DataFrame&#8217;, but the software
internally create an instance of <code>Nyaplot:DataFrame</code> and creates plots
based on it.</p>

<p>To create the same scatter plot as above, run the code below.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">df</span> <span class="o">=</span> <span class="no">Nyaplot</span><span class="o">::</span><span class="no">DataFrame</span><span class="o">.</span><span class="n">new</span><span class="p">({</span><span class="n">a</span><span class="p">:</span> <span class="o">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">]</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="o">[-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="o">]</span><span class="p">})</span>
</span><span class='line'><span class="n">plot</span><span class="o">.</span><span class="n">add_with_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="ss">:scatter</span><span class="p">,</span> <span class="ss">:a</span><span class="p">,</span> <span class="ss">:b</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>You may not feel any advantage of using <code>Plot#add_with_df</code> instead of <code>Plot#add</code>, but the former is useful when creating more complicated plots. <a href="http://nbviewer.ipython.org/github/domitry/Nyaplot/blob/master/examples/notebook/Interaction_with_DataFrame.ipynb">Have a look at the tutorial to learn more.</a></p>

<h2>Conclusion</h2>

<p>My GSoC term has concluded, but that do not mean the end of
development.  There are still many things to do for improvement of
this project.  For example Mapnya and Bionya are both experimental
implementation, and the functionality of Nyaplot::DataFrame is
relatively limited.  If you are interested in this project, please
fork either or both of the two repositories below and send me
pull-requests.</p>

<ul>
<li><a href="https://github.com/domitry/nyaplot">Nyaplot on GitHub</a></li>
<li><a href="https://github.com/domitry/Nyaplotjs">Nyaplotjs on GitHub</a></li>
</ul>


<p>Any form of contribution is welcome.</p>

<p>At last I&#8217;d like to express my gratitude to my mentor Pjotr Prins and
other members of SciRuby community.  I would not have been able to
finish my GSoC term without great help from them.  Feedback from
people outside of the community also helped me a lot.  I had a great
summer thanks to all people related to this project.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Benchmarks for Integration Gem]]></title>
    <link href="http://SciRuby.github.com/blog/2014/07/28/benchmarks-for-integration-gem/"/>
    <updated>2014-07-28T02:44:00-05:00</updated>
    <id>http://SciRuby.github.com/blog/2014/07/28/benchmarks-for-integration-gem</id>
    <content type="html"><![CDATA[<p>The Integration gem now includes quite a few functions from which to
choose. To make this choice easier, I have done some benchmarking to
see how fast and acuurate each of these functions are.  The results of
these tests for some randomly chosen functions are given below. The
speed test reports shows the user CPU time, system CPU time, the sum
of the user and system CPU times, and the elapsed real time to perform
100 iterations of the code. The unit of time is seconds.</p>

<h2>For function f(x)= x<sup>2+3*x+7</sup> on interval (0,1)</h2>

<h3>Speed Tests</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Benchmarking with 100 iterations
</span><span class='line'>                                user     system      total        real
</span><span class='line'>rectangle                  72.040000   0.010000  72.050000 ( 72.058014)
</span><span class='line'>                                user     system      total        real
</span><span class='line'>trapezoid                 105.500000   0.000000 105.500000 (105.489225)
</span><span class='line'>                                user     system      total        real
</span><span class='line'>simpson                     0.020000   0.000000   0.020000 (  0.017601)
</span><span class='line'>                                user     system      total        real
</span><span class='line'>romberg                     0.000000   0.000000   0.000000 (  0.002219)
</span><span class='line'>                                user     system      total        real
</span><span class='line'>adaptive_quadrature         0.010000   0.000000   0.010000 (  0.002757)
</span><span class='line'>                                user     system      total        real
</span><span class='line'>gauss                       0.010000   0.000000   0.010000 (  0.006439)
</span><span class='line'>                                user     system      total        real
</span><span class='line'>gauss_kronrod               0.000000   0.000000   0.000000 (  0.008615)
</span><span class='line'>                                user     system      total        real
</span><span class='line'>simpson3by8                 0.080000   0.000000   0.080000 (  0.074791)
</span><span class='line'>                                user     system      total        real
</span><span class='line'>boole                       0.100000   0.000000   0.100000 (  0.100300)
</span><span class='line'>                                user     system      total        real
</span><span class='line'>open_trapezoid            181.470000   0.050000 181.520000 (181.572745)
</span><span class='line'>                                user     system      total        real
</span><span class='line'>milne                       0.060000   0.000000   0.060000 (  0.058677)
</span><span class='line'>                                user     system      total        real
</span><span class='line'>qng                         0.000000   0.000000   0.000000 (  0.003788)
</span><span class='line'>                                user     system      total        real
</span><span class='line'>qag                         0.010000   0.000000   0.010000 (  0.010407)</span></code></pre></td></tr></table></div></figure>


<h3>Accuracy Tests</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>+---------------------+-------------------+-------------------+------------------------+-------------------+
</span><span class='line'>|       Method        |      Result       |   Actual Result   |         Error          |     Accuracy      |
</span><span class='line'>+---------------------+-------------------+-------------------+------------------------+-------------------+
</span><span class='line'>| rectangle           | 8.833333324123249 | 8.833333333333334 | 9.210085138988688e-09  | 99.99999989573489 |
</span><span class='line'>| trapezoid           | 8.83333334502252  | 8.833333333333334 | 1.1689186507624072e-08 | 99.99999986766959 |
</span><span class='line'>| simpson             | 8.833333333333332 | 8.833333333333334 | 1.7763568394002505e-15 | 99.99999999999997 |
</span><span class='line'>| romberg             | 9.0               | 8.833333333333334 | 0.16666666666666607    | 98.11320754716982 |
</span><span class='line'>| adaptive_quadrature | 8.833333333333334 | 8.833333333333334 | 0.0                    | 100.0             |
</span><span class='line'>| gauss               | 8.750000000006125 | 8.833333333333334 | 0.08333333332720905    | 99.05660377365425 |
</span><span class='line'>| gauss_kronrod       | 8.75              | 8.833333333333334 | 0.08333333333333393    | 99.0566037735849  |
</span><span class='line'>| simpson3by8         | 8.833333333333336 | 8.833333333333334 | 1.7763568394002505e-15 | 99.99999999999997 |
</span><span class='line'>| boole               | 8.833333333333336 | 8.833333333333334 | 1.7763568394002505e-15 | 99.99999999999997 |
</span><span class='line'>| open_trapezoid      | 8.833333325264693 | 8.833333333333334 | 8.068640866554233e-09  | 99.9999999086569  |
</span><span class='line'>| milne               | 8.833333333333334 | 8.833333333333334 | 0.0                    | 100.0             |
</span><span class='line'>| qng                 | 8.833333333333334 | 8.833333333333334 | 0.0                    | 100.0             |
</span><span class='line'>| qag                 | 8.833333333333336 | 8.833333333333334 | 1.7763568394002505e-15 | 99.99999999999997 |
</span><span class='line'>+---------------------+-------------------+-------------------+------------------------+-------------------+</span></code></pre></td></tr></table></div></figure>


<h2>For function f(x) = x<sup>5+7*x<sup>2+2*cos(x)</sup></sup> on interval (0,1)</h2>

<h3>Speed Tests</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Benchmarking with 100 iterations
</span><span class='line'>                                user     system      total        real
</span><span class='line'>rectangle                 534.790000   0.510000 535.300000 (538.238675)
</span><span class='line'>                                user     system      total        real
</span><span class='line'>trapezoid                 835.950000   0.540000 836.490000 (839.233313)
</span><span class='line'>                                user     system      total        real
</span><span class='line'>simpson                     0.650000   0.000000   0.650000 (  0.652694)
</span><span class='line'>                                user     system      total        real
</span><span class='line'>romberg                     0.010000   0.000000   0.010000 (  0.002073)
</span><span class='line'>                                user     system      total        real
</span><span class='line'>adaptive_quadrature         0.170000   0.000000   0.170000 (  0.167520)
</span><span class='line'>                                user     system      total        real
</span><span class='line'>gauss                       0.000000   0.000000   0.000000 (  0.007621)
</span><span class='line'>                                user     system      total        real
</span><span class='line'>gauss_kronrod               0.020000   0.000000   0.020000 (  0.010610)
</span><span class='line'>                                user     system      total        real
</span><span class='line'>simpson3by8                 0.820000   0.000000   0.820000 (  0.831039)
</span><span class='line'>                                user     system      total        real
</span><span class='line'>boole                       0.120000   0.000000   0.120000 (  0.119929)
</span><span class='line'>                                user     system      total        real
</span><span class='line'>open_trapezoid            1019.100000   0.150000 1019.250000 (1020.034828)
</span><span class='line'>                                user     system      total        real
</span><span class='line'>milne                       0.980000   0.000000   0.980000 (  0.970671)
</span><span class='line'>                                user     system      total        real
</span><span class='line'>qng                         0.000000   0.000000   0.000000 (  0.008263)
</span><span class='line'>                                user     system      total        real
</span><span class='line'>qag                         0.020000   0.000000   0.020000 (  0.020050)</span></code></pre></td></tr></table></div></figure>


<h3>Accuracy Tests</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>+---------------------+--------------------+--------------------+------------------------+-------------------+
</span><span class='line'>|       Method        |       Result       |   Actual Result    |         Error          |     Accuracy      |
</span><span class='line'>+---------------------+--------------------+--------------------+------------------------+-------------------+
</span><span class='line'>| rectangle           | 4.182941950501391  | 4.1829419696157935 | 1.9114402505238104e-08 | 99.99999954303927 |
</span><span class='line'>| trapezoid           | 4.182941993679488  | 4.1829419696157935 | 2.406369414842402e-08  | 99.99999942471844 |
</span><span class='line'>| simpson             | 4.182941969798875  | 4.1829419696157935 | 1.8308110583120651e-10 | 99.99999999562314 |
</span><span class='line'>| romberg             | 5.54030230586814   | 4.1829419696157935 | 1.3573603362523468     | 67.5501035847021  |
</span><span class='line'>| adaptive_quadrature | 4.182941969702552  | 4.1829419696157935 | 8.675815621472793e-11  | 99.9999999979259  |
</span><span class='line'>| gauss               | 3.5364151237832213 | 4.1829419696157935 | 0.6465268458325721     | 84.54372901826423 |
</span><span class='line'>| gauss_kronrod       | 3.5364151237807455 | 4.1829419696157935 | 0.6465268458350479     | 84.54372901820506 |
</span><span class='line'>| simpson3by8         | 4.182941969676288  | 4.1829419696157935 | 6.049472034419523e-11  | 99.99999999855378 |
</span><span class='line'>| boole               | 4.182941969615793  | 4.1829419696157935 | 8.881784197001252e-16  | 99.99999999999997 |
</span><span class='line'>| open_trapezoid      | 4.182941952971977  | 4.1829419696157935 | 1.6643816103112385e-08 | 99.99999960210263 |
</span><span class='line'>| milne               | 4.18294196954598   | 4.1829419696157935 | 6.981348832368894e-11  | 99.99999999833099 |
</span><span class='line'>| qng                 | 4.182941969615793  | 4.1829419696157935 | 8.881784197001252e-16  | 99.99999999999997 |
</span><span class='line'>| qag                 | 4.1829419696157935 | 4.1829419696157935 | 0.0                    | 100.0             |
</span><span class='line'>+---------------------+--------------------+--------------------+------------------------+-------------------+</span></code></pre></td></tr></table></div></figure>


<p>If you are keen to test any function of your choice you can pull from
<a href="https://github.com/rajatkapoor/integration">my Integration gem fork</a>
and change the files in the benchmark folder. For both the files,
<code>accuracy.rb</code> and <code>speed.rb</code>, change the line <code>func = lambda{|x| f(x)}</code>
with <code>f(x)</code> as your desired function. In case you want to perform
accuracy benchmarks, make sure that you know the exact result of the
integration operation before hand and assign this value to the
variable <code>actual_result</code> Feel free to comment if you face any problem
running the benchmarks with your desired functions.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[The Nyaplot internal event handler]]></title>
    <link href="http://SciRuby.github.com/blog/2014/07/09/nyaplot-internal-event-handler/"/>
    <updated>2014-07-09T17:01:00-05:00</updated>
    <id>http://SciRuby.github.com/blog/2014/07/09/nyaplot-internal-event-handler</id>
    <content type="html"><![CDATA[<p><img src="https://dl.dropboxusercontent.com/u/47978121/gsoc/multiple_panes.png" alt="Nyaplot multi-pane example" /></p>

<h2>Introduction</h2>

<p>Last week I implemented the multiple panes interactivity to the
front-end of Nyaplot. You can see the demo on <a href="http://nbviewer.ipython.org/github/domitry/Nyaplot/blob/master/examples/notebook/Introduction.ipynb">this notebook</a>.</p>

<p>Skip over single pane demo, and have a look at the paragraph &#8216;Multiple
panes demo&#8217; at the bottom. In this example, the histogram and bar chart are
created individually, and then thrown into one instance of
Nyaplot::Frame. After running <code>frame.show</code>, both of the diagrams
appear in one out-put box on the notebook. When you click the
histogram, bar chart refrects that and change its height.</p>

<p>In this article I will explain about the event handler of Nyaplot,
which allows for interactivity among panes.</p>

<h2>The Trick</h2>

<p>The trick is actually hidden in Nyaplot::DataFrame. In this example,
both of the two diagrams are generated from columns in one DataFrame.
When Nyaplot receives a column object (instance of <code>Nyaplot::Series</code>,
defined
<a href="https://github.com/domitry/nyaplot/blob/93ee183b935a7deafa388f2a198792e86914d550/lib/nyaplot/data.rb#L130">here</a>), it
internally find its source data frame and remembers its location.</p>

<p>Consequently, Nyaplot can find that histogram and bar chart are
sharing their data source, and allows them to interact with each other.</p>

<p><img src="https://dl.dropboxusercontent.com/u/47978121/gsoc/table.png" alt="Nyaplot::DataFrame Example" /></p>

<h2>Implementation</h2>

<p>Before explaining the event handler, I want to outline Nyaplot&#8217;s
diagram rendering procedure. In the back-end JavaScript library,
diagrams, such as histograms, fetch column data from data frames and generate
their SVG DOM nodes dynamically (<a href="https://github.com/domitry/Nyaplotjs/blob/0aa104aed467f39da89ba3ed72be5f159a0261b8/src/view/diagrams/histogram.js#L20">source code</a>).</p>

<p>The key is <a href="https://github.com/domitry/Nyaplotjs/blob/0aa104aed467f39da89ba3ed72be5f159a0261b8/src/utils/dataframe.js">a data frame written in JavaScript</a>. After mouse events
coming from a filter (such as the gray box on the plot area) are
handled, the histogram <a href="https://github.com/domitry/Nyaplotjs/blob/0aa104aed467f39da89ba3ed72be5f159a0261b8/src/view/diagrams/histogram.js#L96">registers its filter function to the data frame and instructs all diagrams to update their SVG DOM objects</a>. The bar chart <a href="https://github.com/domitry/Nyaplotjs/blob/0aa104aed467f39da89ba3ed72be5f159a0261b8/src/view/diagrams/bar.js#L54">updates its SVG from data filtered by the new function</a>.</p>

<p>As you can see, Nyaplot&#8217;s inner workings are fairly simple; and these
workings are common to all diagrams supported by Nyaplot. So not only
the histogram and bar chart, but other diagrams as well, can behave
interactively (e.g., <a href="http://www.domitry.com/gsoc/multi_pane2.html">histogram, bar, and Venn example</a>).</p>

<h2>Conclusion</h2>

<p>Despite, or perhaps because of, the relative simplicity of the
structure, the event handler functions well. The actual interactivity
in Nyaplot is based on the data frame object, both in the
Ruby front-end and the JavaScript back-end. As a result, handling
events in DataFrame is both natural and efficient for Nyaplot.</p>

<h2>Additional Information</h2>

<p>Nyaplot and its back-end library Nyaplotjs are being developed on GitHub.</p>

<ul>
<li><a href="https://github.com/domitry/nyaplot">Nyaplot on GitHub</a></li>
<li><a href="https://github.com/domitry/Nyaplotjs">Nyaplotjs on GitHub</a></li>
</ul>


<p>If you are interesed, feel free to try it and raise issues or send pull-requests.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Usage: Integration Gem Improvements]]></title>
    <link href="http://SciRuby.github.com/blog/2014/07/02/usage-integration-gem-improvements/"/>
    <updated>2014-07-02T17:43:00-05:00</updated>
    <id>http://SciRuby.github.com/blog/2014/07/02/usage-integration-gem-improvements</id>
    <content type="html"><![CDATA[<h2>Numerical Integration</h2>

<p>Integration is the process of finding the summation of the value of a function at small intervals, when the width of the intervals is infinitesimally small.
As there is no such thing as &#8220;infinitesimally small interval&#8221;, there are several other methods which help us to approximate the values of integrals.</p>

<p>Numerical integration is one such technique which helps us to estimate the value of the definite integral of a function over an interval.
Numerical integration is based on the principle of evaluating the values of a function at specific points in the interval and then taking the product of those values with a corresponding weight, which is a standard constant specific to the method being used.</p>

<h2>Integration Gem</h2>

<p>The Integration gem is now equipped with a host of additional algorithms for approximating the integral of a function ranging from the simple ones like Simpson&#8217;s method to the more complex ones like Gauss&ndash;Kronrod and Adaptive Quadrature method.</p>

<h2>Example</h2>

<p>Let us say you need to find out the integral of a function <code>5*x**2 -7*Math.cos(x)</code> over the interval <code>(0,1)</code>.
We can solve this using the following snippet using the Integration gem:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Integration</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,{</span><span class="ss">:method</span><span class="o">=&gt;</span><span class="ss">:simpson</span><span class="p">})</span> <span class="p">{</span><span class="o">|</span><span class="n">x</span><span class="o">|</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span><span class="mi">7</span><span class="o">*</span><span class="no">Math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)}</span>
</span><span class='line'><span class="c1"># =&gt; -4.223630227110514</span>
</span></code></pre></td></tr></table></div></figure>


<p>We see that the actual value of this integral is <code>-4.2236302269886088799000849584</code>, which is pretty close to the value estimated by the integration gem.
Instead of <code>{:method=&gt;:simpson}</code> in the above code, you can use any one of these implemented methods:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">rectangle</span><span class="p">,</span><span class="ss">:trapezoid</span><span class="p">,</span><span class="ss">:simpson</span><span class="p">,</span> <span class="ss">:adaptive_quadrature</span> <span class="p">,</span> <span class="ss">:gauss</span><span class="p">,</span> <span class="ss">:romberg</span><span class="p">,</span> <span class="ss">:monte_carlo</span><span class="p">,</span> <span class="ss">:gauss_kronrod</span><span class="p">,</span> <span class="ss">:simpson3by8</span><span class="p">,</span> <span class="ss">:boole</span><span class="p">,</span> <span class="ss">:open_trapezoid</span><span class="p">,</span> <span class="ss">:milne</span>
</span></code></pre></td></tr></table></div></figure>


<p>Each of these algorithms gives similar results &mdash; except if the function has rapid changes in the interval of integration, as is the nature of numerical integration.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[The progress of the GSoC D3/Visualization Project]]></title>
    <link href="http://SciRuby.github.com/blog/2014/07/02/progress-of-d3-project/"/>
    <updated>2014-07-02T17:09:00-05:00</updated>
    <id>http://SciRuby.github.com/blog/2014/07/02/progress-of-d3-project</id>
    <content type="html"><![CDATA[<p>This week is the half-way point of this year&#8217;s Google Summer of
Code. Let me report the progress during the term.</p>

<p><img src="https://dl.dropboxusercontent.com/u/47978121/gsoc/nyaoplot_top.png" alt="Example Nyaplot chart of a spiral" /></p>

<h2>Progress on the front-end library</h2>

<p>I am developing <a href="https://github.com/domitry/Nyaplot">Nyaplot</a> as the front-end library
for my work.</p>

<p>One topic on Nyaplot is API design. That is a difficult problem since
each plotting library has very different methods for creating
plots. For example, matplotlib and Bokeh are both written in Python,
but their demo code is written in very different styles. After
discussing with my mentor, I decided to implement the function-based
API.</p>

<p>As an exmaple of that API, here is a minimal working example for
generating bar charts with Nyaplot:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;nyaplot&#39;</span>
</span><span class='line'><span class="n">plot</span> <span class="o">=</span> <span class="no">Nyaplot</span><span class="o">::</span><span class="no">Plot</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'><span class="n">plot</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="ss">:bar</span><span class="p">,</span> <span class="o">[</span><span class="s1">&#39;nya1&#39;</span><span class="p">,</span> <span class="s1">&#39;nya2&#39;</span><span class="p">,</span> <span class="s1">&#39;nya3&#39;</span><span class="o">]</span><span class="p">,</span><span class="o">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'><span class="n">plot</span><span class="o">.</span><span class="n">show</span>
</span></code></pre></td></tr></table></div></figure>


<p>If you want to change options (<em>e.g.</em>, color or title), put the return
value of <code>Nyaplot::Plot.add</code> into a variable and call its methods.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">bar</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="ss">:bar</span><span class="p">,</span> <span class="o">[</span><span class="s1">&#39;nya1&#39;</span><span class="p">,</span> <span class="s1">&#39;nya2&#39;</span><span class="p">,</span> <span class="s1">&#39;nya3&#39;</span><span class="o">]</span><span class="p">,</span><span class="o">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'><span class="n">bar</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;the number of cats&quot;</span><span class="p">)</span> <span class="c1"># name the bar chart</span>
</span></code></pre></td></tr></table></div></figure>


<h2>IRuby integration</h2>

<p>Interaction with <a href="https://github.com/minad/iruby">IRuby</a> is a priority
for Nyaplot. IRuby is a web-based Ruby lab notebook-like environment,
based on IPython, which is also useful for fast prototyping.</p>

<p>The image at the top of this blog post is a hyperbolic spiral which I
generated with Nyaplot in IRuby. <a href="http://nbviewer.ipython.org/github/domitry/Nyaplot/blob/master/examples/notebook/Introduction.ipynb">Have a look at the
notebook</a>
on nbviewer, an IRuby and IPython notebook hosting services.</p>

<h2>Progress on the back-end library</h2>

<p>Nyaplot uses <a href="https://github.com/domitry/Nyaplotjs">Nyaplotjs</a> as its
back-end library. I spent a lot of time working to implement
interactivity among multiple panes to Nyaplotjs. <a href="http://www.domitry.com/gsoc/multi_pane2.html">See an
example here.</a></p>

<p><img src="https://dl.dropboxusercontent.com/u/47978121/gsoc/top.png" alt="Three-pane interactivity screenshot" /></p>

<p>The input data source is a TSV file of 2,044 lines. Multiple-pane
interactivity is especially important when visualizing such a large
dataset.</p>

<p>Have a look at the radio buttons beside the Venn diagram. The left
three panels decide which set to put into each of three circles
(VENN1, VENN2, VENN3). The right panel decides which data in each area
(overlapping area, non-overlapping area, and all) to use in the other
two panes.</p>

<p>The gray box on the histogram decides the range of PNR values. If you
select the range 0.3 to 0.7 with it, the right bar chart will reflect
that and show how many of the selected data are in that range.</p>

<p>Nyaplotjs provides this interactivity using an event handler connected
to a dataframe object. That allows us to handle unidirectional update
method (<em>e.g.</em>, histogram updates bar chart, but bar chart does not
update histogram).</p>

<h2>Conclusion</h2>

<p>I finished the first half term of Google Summer of Code 2014, but I
still have a lot of things to do. I would like to continue to add
interactivity to both the front-end and back-end libraries.</p>

<p>I am developing those two libraries in separate repositories on
GitHub. If you are interested, feel free to raise issues or send
pull-requests, even during the GSoC term.</p>

<ul>
<li><a href="https://github.com/domitry/Nyaplot">Nyaplot - GitHub</a></li>
<li><a href="https://github.com/domitry/Nyaplotjs">Nyaplotjs - GitHub</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Updates: Minimization and Integration]]></title>
    <link href="http://SciRuby.github.com/blog/2014/06/24/updates-minimization-and-integration/"/>
    <updated>2014-06-24T14:32:00-05:00</updated>
    <id>http://SciRuby.github.com/blog/2014/06/24/updates-minimization-and-integration</id>
    <content type="html"><![CDATA[<h2>Minimization</h2>

<p>The Minimization gem now supports the following unidimensional function minimizations
provided by GSL. The supported methods include the pure Ruby implementations of:</p>

<ol>
<li>Newton&ndash;Raphson</li>
<li>Golden Section</li>
<li>Brent</li>
<li>Quad Golden</li>
</ol>


<p>Of these, the Golden Section, Brent, and Quad Golden are also
available via Minimization&#8217;s GSL interface (and are thus
faster). Everything is organized in such a way that the faster C code
(i.e., GSL) will be executed when GSL is available, but that otherwise
the Ruby implementation will be used. I still have to beautify the
code and add documentation.</p>

<h2>Integration</h2>

<p>The Integration gem has been transitioned from Hoe to Bundler. For
Gauss&ndash;Kronrod Quadrature, I have hard-coded the values of nodes
and weights (for 15, 21, 31, 41, and 61 points) &#8212; which were already
hardcoded in the case of the Gauss quadrature.</p>

<p>Additionally, I added basic methods like Simpson&#8217;s Three-Eighths
Method, Milne&#8217;s Method, Boole&#8217;s Quadrature and Open Trapezoid.</p>

<p>This week, I will be reviewing a <a href="https://github.com/clbustos/integration/pull/3">pull request</a> which aims to change the structure of the whole Integration gem.</p>

<p>After that I plan to implement more adaptive methods and incorporate
the non-adaptive methods under a single Newton&ndash;Cotes function.</p>

<p>Lastly, I am brainstorming designs for symbolic integration using
JScience and JRuby.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Progress on Minimization methods]]></title>
    <link href="http://SciRuby.github.com/blog/2014/06/19/progress-on-minimization-methods/"/>
    <updated>2014-06-19T01:00:00-05:00</updated>
    <id>http://SciRuby.github.com/blog/2014/06/19/progress-on-minimization-methods</id>
    <content type="html"><![CDATA[<h2>Current Progress on Minimization Gem</h2>

<p>In the first half of the summer, I plan to introduce some new numerical minimization methods to SciRuby&#8217;s Minimization gem. As per my proposal, I began by implementing the Powell&#8217;s multidimensional minimization method. Powell&#8217;s method has a better convergence in most cases than the Nelder&ndash;Mead algorithm, and is also a multidimensional minimization method which doesn&#8217;t use any derivative of the function.</p>

<p>I started by studying SciPy and Apache Commons library&#8217;s Powell&#8217;s optimizer. I decided to base my implementation on the method from the <a href="http://commons.apache.org/proper/commons-math/">Apache Commons Mathematics Library</a>. Powell&#8217;s method requires a line minimum searching algorithm, for which I used Brent minimizer (already available in SciRuby).</p>

<p>Having finished with Powell&#8217;s method, I am now working on the Fletcher&#8211;Reeves minimization method &mdash; a gradient method which uses the first derivative of the integrating function.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Introduction: Minimization and Integration (Lahiru)]]></title>
    <link href="http://SciRuby.github.com/blog/2014/06/18/introduction-minimization-and-integration/"/>
    <updated>2014-06-18T16:45:00-05:00</updated>
    <id>http://SciRuby.github.com/blog/2014/06/18/introduction-minimization-and-integration</id>
    <content type="html"><![CDATA[<p class="note"><strong>Editor&#8217;s Note:</strong> We have two students
working on numerical minimization and integration this summer, Rajat and
Lahiru. Rajat&#8217;s introductory post appeared two weeks ago.</p>


<h2>Introduction </h2>

<p>I&#8217;m Lahiru Lasandun and I&#8217;m an undergraduate of University of Moratuwa, Sri Lanka. I&#8217;ve been selected for
Google Summer of Code 2014 for SciRuby&#8217;s Minimization and Integration projects.</p>

<p>I was working with SciRuby about a month before GSOC started and did some tests on how to enhance the performance of
these numerical computations. My first idea was to use multi-threading. With the instuctions and guidance of mentors, I
tested more methods such as Erlang multi-processing, the AKKA package of multi-threading, and finally OpenCL. The final
decision was to use OpenCL to enhance computation power of these mathematical computations with the support of multi-cores
and GPUs.</p>

<h2>Minimization Gem</h2>

<p>After GSOC started, I began working on SciRuby&#8217;s Minimization gem. I proposed multidimensional minimization methods for the
Minimization gem, which already had plenty of unidimensional minimization methods. I chose two non-gradient
and two gradient minimization methods as well as simulated annealing.</p>

<h2>Integration Gem</h2>

<p>For Integration, I proposed to replicate some unidimensional integration methods from the GNU Scientific Library, GSL. Additionally, I proposed to add OpenCL support to enhance performance of integration methods.</p>

<h2>Current Progress</h2>

<p>Currently, I am working on Nelder&ndash;Mead multidimensional minimization
method which is a non-gradient method, including working on the relevant
test cases.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Introduction to the Minimization and Integration project (Rajat)]]></title>
    <link href="http://SciRuby.github.com/blog/2014/06/04/introduction-to-the-minimization-and-integration-project/"/>
    <updated>2014-06-04T14:23:00-05:00</updated>
    <id>http://SciRuby.github.com/blog/2014/06/04/introduction-to-the-minimization-and-integration-project</id>
    <content type="html"><![CDATA[<p class="note"><strong>Editor&#8217;s Note:</strong> We have two students
working on numerical minimization and integration this summer, Rajat and
Lahiru. Lahiru will be writing a separate post about his work.</p>


<h2>Introduction to the Minimization and Integration Project</h2>

<p>Hi. My name is Rajat Kapoor and I have been selected to work with
SciRuby for Google Summer of Code 2014.</p>

<p><a href="https://github.com/SciRuby/minimization">Minimization</a> and
<a href="https://github.com/SciRuby/integration">Integration</a> are two of the
many available gems in the SciRuby suite. My project this year aims to
improve these gems to replicate the functionality provided by GNU&#8217;s
GSL. I will be trying to implement all the minimization and
integration algorithms present in GSL in pure Ruby, with improvements
as needed, so that these functions are easily accesible to all Ruby
users, while the users which have GSL already installed will have an
advantage in terms of speedy computations.</p>

<h2>What Minimization and Integration actually mean</h2>

<p>Minimization refers to the process of finding out the minimum of a
mathematical function whose values might depend on multiple
variables. Unidimensional minimization restricts these problems to
functions of one single variable. Integration is the same as the very
widely used concept in calculus which basically boils down to finding
the summation of the value of a function at small intervals, when the
width of the intervals in infinitesimally small. I can bet that you
knowingly or unknowingly use both these things on a daily basis.</p>

<h2>The plan</h2>

<p>The project can be broken into two major parts: Minimization and
Integration, as these are two seperate gems.</p>

<p>The Minimization gem can be broken in two parts: unidimensional (or
univariate) and multidimensional (multivariate). With respect to
coding, these two can again be broken down into sub-parts: pure Ruby
implementations and GSL support. The Integration gem will include
the pure Ruby implementations as well as GSL support. Along with this,
some support for symbolic integration will be added for JRuby
users by way of the JScience library.</p>

<h2>Progress</h2>

<p>The pure Ruby implementations of the unidimensional minimization part
are almost finished. I am also working on the GSL support for the same
along with it. I plan to finish up any unidimensional minimization
work by the end of this week and start the work with multidimensional
minimization methods.</p>

<p>Keep watching this blog for more updates regarding my project.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Introducing the FFTW SciRuby GSoC project]]></title>
    <link href="http://SciRuby.github.com/blog/2014/06/04/introducing-the-fftw-sciruby-gsoc-project/"/>
    <updated>2014-06-04T12:30:00-05:00</updated>
    <id>http://SciRuby.github.com/blog/2014/06/04/introducing-the-fftw-sciruby-gsoc-project</id>
    <content type="html"><![CDATA[<p>My name is Magdalen Berns and I am a physics student with a technical
background in live audio. I am particularly interested in using science
and technology to improve access for all.</p>

<p>This summer, I will be working on implementing the external library
appropriately named &#8220;Fastest Fourier Transform in the West&#8221; version 3
(FFTW3) C and Fortran API in Ruby for this year&#8217;s Google Summer of Code
(GSoC).</p>

<p>The primary aim of the project is to give SciRuby the capability to
handle signal analysis, processing and synthesis by performing discrete
fast Fourier transform operations on NMatrix objects.</p>

<p>After some investigation during the preparation stages of GSoC, it was
determined that implementing FFTW3 is more desirable than starting from
scratch in pure Ruby because the FFTW3 API is already extensively used,
developed, and optimised far beyond what would be achievable in just
three months. So, putting FFTW3 in the driving seat allows the SciRuby
project to take advantage of the good work of the FFTW3 developers by
bringing it to Ruby.</p>

<p>Putting NMatrix to the test with FFTW3 should give users the
opportunity to test drive NMatrix &mdash; and SciRuby&#8217;s NMatrix developers a
chance to root out bugs.</p>

<p>Since a gem called ruby-fftw3 already existed to perform FFTW3 operations
on NArray objects, I forked that repository as a starting point. <a href="https://github.com/thisMagpie/fftw">Things are progressing on my Github fork</a> right now.</p>

<p>My mentor for this project is Colin Fuller who is an exceptionally
talented programmer &mdash; and he really knows his git too. He has been a
great help as I adapt to the learning curve of working in C and
Ruby (languages which I am less familiar with than say, Java or
JavaScript).</p>

<p>As I work, I intend to share useful gems of information I gather. Those, in addition to my weekly project updates, will appear right here in this blog so others can hopefully benefit.</p>

<p>I have already posted a few useful bits and bobs on
<a href="http://thismagpie.com">thismagpie.com</a> which relate to my work so far.
I hope to add those to the SciRuby blog, too, provided
the readers are interested in that and time permits. Of course, readers here can feel free to have a browse
of the keywords <a href="http://thismagpie.com/keyword/sciruby">sciruby</a>,
<a href="http://thismagpie.com/keyword/ruby">ruby</a> and
<a href="http://thismagpie.com/keyword/git">git</a> on there for the time being.
I sometimes add posts, manuals and tutorials from external sites where I
find useful ones on the web too, so watch out for these too.</p>

<p>Please, feel free to watch or follow along as the project comes together
and those inclined are welcome to share constructive comments and advice
or raise bugs on the fftw3 issue tracker. Input about my work is very
welcome as the project progresses. This gem is being written for the
community, after all!</p>

<p>You can find me on Twitter (Facebook) or GitHub under the username @thisMagpie.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Introducing the GSoC 2014 D3 Project]]></title>
    <link href="http://SciRuby.github.com/blog/2014/06/02/introducing-gsoc-2014-the-d3-project/"/>
    <updated>2014-06-02T14:00:00-05:00</updated>
    <id>http://SciRuby.github.com/blog/2014/06/02/introducing-gsoc-2014-the-d3-project</id>
    <content type="html"><![CDATA[<p>Hello. I am Naoki, one of four Google Summer of Code (GSoC) 2014
students in SciRuby. Let me introduce my project. The goal of the GSoC
2014 D3 Project is to create a new plotting library for
SciRuby. <a href="http://d3js.org/">D3.js</a> is the most suitable JavaScript
library to achieve this goal.</p>

<p>There are several non-Ruby plotting software libraries in the wild,
like ggplot, matplotlib, and ggplot2. Actually, SciRuby already has
its own plotting libraries named
<a href="https://github.com/SciRuby/plotrb">Plotrb</a> and
<a href="https://github.com/SciRuby/rubyvis">Rubyvis</a>. The main feature of my
project compared with those software packages is <em>interactivity</em>.
Interactivity has various meanings here: interactivity when generating
plots, interactivity when viewing them, and server&ndash;client
interactivity. My project includes all of those.</p>

<p>My project can be divided into two components, one JavaScript and the
other Ruby. JavaScript serves as a back-end, and Ruby as a
front-end. I&#8217;m currently working on the former part. Have a look at a
few examples I&#8217;ve assembled:</p>

<ul>
<li><a href="http://bl.ocks.org/domitry/b8785f02f36deef567ce">Multiple panes</a></li>
<li><a href="http://bl.ocks.org/domitry/2f53781449025f772676">Bar chart</a></li>
<li><a href="http://bl.ocks.org/domitry/e9a914b78f3a576ed3bb">Line</a></li>
<li><a href="http://bl.ocks.org/domitry/308e27d8d12c1374e61f">Scatter</a></li>
<li><a href="http://bl.ocks.org/domitry/f215d5ff3bd3f5fec2ad">Another theme</a></li>
</ul>


<p>This project involves a number of challenges, but I believe it to be
achievable during this Summer of Code. Thank you for reading!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ruby Science Foundation selected for GSoC 2014]]></title>
    <link href="http://SciRuby.github.com/blog/2014/02/24/gsoc-2014/"/>
    <updated>2014-02-24T21:45:00-06:00</updated>
    <id>http://SciRuby.github.com/blog/2014/02/24/gsoc-2014</id>
    <content type="html"><![CDATA[<p>We&#8217;re excited to announce that the Ruby Science Foundation has been selected as
a mentoring organization for <a href="https://www.google-melange.com/gsoc/homepage/google/gsoc2014">Google Summer of Code 2014</a>!</p>

<p>Last year
was our first year as a mentoring organization, and we had a great group of
students working with us on machine learning, timeseries statistics, the
semantic web, and scientific plotting.</p>

<p>This year we&#8217;ve got a super set of
possible projects including more flexible matrix computations, automatic Ruby
interface generation for scientific libraries, a dataframe library for
structuring and manipulating datasets, interactive plotting, a scientific
notebook, high-performance minimization and integration libraries, and a
semantic web datastore backend for scientific computing.</p>

<p>If you&#8217;re interested in applying as a student, learning more, or even
contributing independent of GSoC, head over to our <a href="https://github.com/SciRuby/sciruby/wiki/Google-Summer-of-Code-2014-Ideas">GSoC 2014 ideas page</a>
to see what projects we think are great.  Don&#8217;t hesitate to tell us if you&#8217;ve
got an amazing idea for a different project, too! If you&#8217;re still left
wondering where to start, check out the <a href="https://github.com/sciruby/nmatrix/issues">issue tracker for NMatrix</a>, the matrix computation
library used as the basis for a number of our projects, and our top priority at
the moment.</p>

<p>Good luck to all the GSoC applicants out there, and happy coding!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Some words from GSoC 2013 alumni]]></title>
    <link href="http://SciRuby.github.com/blog/2014/01/28/gsoc-alumni/"/>
    <updated>2014-01-28T16:07:00-06:00</updated>
    <id>http://SciRuby.github.com/blog/2014/01/28/gsoc-alumni</id>
    <content type="html"><![CDATA[<p>In 2013, SciRuby was a mentoring organization for the Google Summer of Code. We
asked our alumni:</p>

<p>1) How did you experience GSoC/SciRuby and what has it brought you?</p>

<p>2) What advice would you give new applicants?</p>

<p>Monica Dragan from Romania worked on <a href="https://github.com/monicadragan/GeneValidator">gene validation</a>, see also her
<a href="http://gene-prediction.blogspot.nl/2013/08/start-using-our-gene-validation-tool.html">blog</a>. Actually, Monica
was part of a different GSoC organisation,
<a href="http://informatics.nescent.org/wiki/Phyloinformatics_Summer_of_Code_2013">PhyloSoC</a>,
but also participated in our Ruby-centric meetings and code reviews. She shared
her SciRuby GSoC experience:</p>

<p class="note"><strong>Monica:</strong>
During the GSoC period I developed a bioinformatics tool written in Ruby. First of all I learned a new programming
language, as I had no experience with Ruby before. On this GSoC occasion I had the opportunity to get in touch with the
community and I met people passionate about their work, with whom I continued
 the collaboration afterwards. But what I really gained from this experience is that I increased my enthusiasm about
 bioinformatics and I confirmed myself that this is the field I want to focus on in the next years.
</p>


<p>Alberto Arrigoni from Italy worked on <a href="http://sciruby.com/blog/2013/09/24/gsoc-2013-data-mining-in-jruby-with-ruby-band/">data mining and machine learning algorithms for Ruby</a> and shared
his GSoC experience:</p>

<p class="note"><strong>Alberto:</strong>
As a PhD student in the field of bioinformatics, my GSOC experience was very exciting and useful at different levels. On a training level, I had the
unique chance to learn more in depth some topics of machine learning I had
wanted to explore in the past, but never had quite the opportunity or the
resources. On a more technical level, I appreciated the support of the GSOC
mentors and the Sciruby community, which counts numerous experts and a very
active mailing list.
</p>


<p>Ankur Goel from India worked on
<a href="http://rubygems.org/gems/statsample-timeseries">statsample-timeseries</a> for Ruby.
Ankur shared,</p>

<p class="note"><strong>Ankur:</strong>
It was the best learning experience. I learnt quite a lot of statistics while
working on my TimeSeries extension; after GSoC, I picked up Machine Learning
course and I was able to relate it to very easily after working on regression
techniques in GLM extension. I can&#8217;t thank enough for the opportunity provided
and the trust endowed by my mentor on me. Learning to write quality code and
getting reviews was a cherry on cake! 
</p>


<p>Will Strinz from Madison, USA, worked on <a href="http://localhost:4000/blog/2013/10/12/ruby-and-the-semantic-web-rdf-sparql-publisci/">RDF generators for Ruby</a> for the
semantic web:</p>

<p class="note"><strong>Will:</strong>
GSoC 2013 was a new experience for me in terms of managing my own time,
planning my own project, and keeping up consistent interaction with my mentors
across time zones. Despite a decent amount of prior experience with Ruby, it
was also a challenge and an opportunity for me to really understand the tools
and practices I knew, and learn to use the ones I wasn&#8217;t familiar with.

As for what it&#8217;s brought me, aside from a job I secured partly through skills
and project portfolio I gained during GSoC, and the power of knowing how to do
just about any programming task using Ruby, I learned a lot about how to manage
a project and interact with people in the real world.

Communicating properly and in a timely manner over email and other asynchronous
services is absolutely critical to the work I do now, and a lot harder than
people make it out to be. Staying in touch with my mentors and making sure we
were all on the same page about my project was something I spent a lot of time
on, and in doing so I gained a lot of comfort with the process.

Additionally, GSoC was my first true experience designing a large piece of
software, where I couldn&#8217;t just give up and trash it when the code started
getting messy or confusing. It really forced me to adopt good practices around
testing and organization, especially since I had better programmers than myself
looking over my work.

Software architecture is something you just don&#8217;t learn in college level CS
courses, and by the time I&#8217;d graduated, I&#8217;d started hearing a lot of my CS
professors saying this too. Some day in the future, maybe soon, there will be
classes taught about just this subject, but for now there&#8217;s no better way to
learn about it than by working on a real project, with some accountability and
motivation to actually get it done.


</p>


<p>Our alumni give new GSoC applicants the following advice:</p>

<p class="note"><strong>Monica:</strong>
GSoC is a great experience that you should try as a student! What is cool about GSoC is that you work on the project you are keen on and manage your time as
 you wish. Also, working remotely involves additional challenges. In the end you improve your experience and get to know a lot of new and great people.

</p>




<p class="note"><strong>Alberto:</strong>

I think one of the best features offered by the GSOC is the possibility to
collaborate with (and learn from) people who share the same scientific
interests and have very different backgrounds and skills. Though this may be
somewhat &#8216;expected&#8217; for mentors, I was also lucky to find other GSOC students
willing to bond and share experiences and opinions. My advice is to be
cooperative and try to learn as much as possible from/with them!  

</p>




<p class="note"><strong>Ankur:</strong>
Work really hard. Do your homework before you ask questions or before quoting
anything in proposal. Writing a good proposal is necessary, and you must really
be aware of what you are writing - a good research is necessary. SciRuby
community members are readily available to help you at mailing list and #sciruby channel. A thorough discussion with the mentor will help you out.
</p>




<p class="note"><strong>Will:</strong>
To new applicants this year I&#8217;d stress one thing above all else; get in
touch with people on the sciruby mailing list. Introduce yourself as soon as
possible, and start discussing your project ideas when you have something in
mind. People on the mailing list are very friendly and helpful, so don&#8217;t be
afraid to start a conversation, but also expect constructive criticism of your
proposals.

Answering any questions or concerns promptly and thoroughly not only shows that
your know your stuff and are passionate about your project, it also shows that
you are a good fit for GSoC in general. Don&#8217;t assume you&#8217;re in just because
you&#8217;ve had a good dialogue, but plan and communicate as though you are; don&#8217;t
wait for the project to start to fill in details or contact your prospective
mentors personally.

Once you&#8217;ve submitted a proposal, all of this goes double. The closer you get
to the deadline, the less time there will be to polish your application and
respond to questions, so make sure you&#8217;re doing it quickly and effectively.
</p>


<p>Our SciRuby GSoC alumni added:</p>

<p class="note"><strong>Monica:</strong>
If I don&#8217;t join this year, I wish you good luck with the new students!
</p>




<p class="note"><strong>Ankur:</strong>
I will be happy to sign up again as student, this year!
</p>




<p class="note"><strong>Will:</strong>
I know I&#8217;ve said this already, but GSoC last year was a defining moment in my
path to becoming a software developer, career-wise sure, but more importantly
in the coder vs hacker vs computer scientist vs software developer sense. If
there&#8217;s anything I can do to get involved this year, I&#8217;ll be available.<p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Statistics with Ruby: Time Series and General Linear Models]]></title>
    <link href="http://SciRuby.github.com/blog/2013/11/07/statistics-with-ruby-time-series-and-general-linear-models/"/>
    <updated>2013-11-07T13:15:00-06:00</updated>
    <id>http://SciRuby.github.com/blog/2013/11/07/statistics-with-ruby-time-series-and-general-linear-models</id>
    <content type="html"><![CDATA[<p class="note"><strong>Editor&#8217;s Note:</strong> This is the third of four blog posts detailing our Google Summer of
Code 2013 students&#8217; work, edited by John Woods.</p>




<p class="note"><strong>Gem Maintainer&#8217;s Note:</strong> These gems have changed recently. Edits reflect the changes.</p>


<h2>Introduction</h2>

<p><a href="https://github.com/clbustos/statsample/">Statsample</a> is a basic and advanced statistics suite in Ruby. It attempts to support JRuby and MRI/YARV equally, and also provides pure Ruby implementations for many functions.</p>

<p>Statsample is a ruby gem for statistical analysis in ruby.</p>

<p>It includes a rich API, except for problems involving time series and generalized linear models (GLM), for which the functionality was rather basic.</p>

<p>So, in this <a href="https://www.google-melange.com/gsoc/homepage/google/gsoc2013">Google Summer of Code 2013</a> program, working on the SciRuby Project, I released two extensions:</p>

<ul>
<li><a href="http://github.com/sciruby/statsample-timeseries">Statsample TimeSeries</a></li>
<li><a href="https://github.com/sciruby/statsample-glm">Statsample GLM</a></li>
</ul>


<p>These gems aim to take Statsample further and incorporate various functionalities and estimation techniques on continuous data.</p>

<h2>Statsample TimeSeries</h2>

<p><a href="https://rubygems.org/gems/statsample-timeseries"><em>Statsample TimeSeries</em></a> is equipped with a variety of operations. A few of those functionalities are:</p>

<ul>
<li>_<a href="http://en.wikipedia.org/wiki/Autocorrelation">Autocorrelation</a> of series: For finding repeating patterns (like a periodic signal) in noisy data or for identifying persistence (if it rained today, will it rain tomorrow?).</li>
<li><a href="http://en.wikipedia.org/wiki/Autoregressive_moving_average_model">Autoregressive and Moving Average</a>: Autoregressive models (AR and ARMA) are useful for describing random processes such as found in nature and economics believed to be
predictable from past behavior (e.g., El Niño, the stock market).</li>
<li><a href="http://en.wikipedia.org/wiki/Partial_autocorrelation_function">Partial autocorrelation</a> with Yule&ndash;Walker, a method for calculating the coefficients of autoregressive models.</li>
<li><a href="http://en.wikipedia.org/wiki/Levinson_recursion">Levinson&ndash;Durbin</a> estimation: for <a href="http://www.mathworks.com/help/dsp/ref/levinsondurbin.html">solving linear equations</a> involving a <a href="http://en.wikipedia.org/wiki/Toeplitz_matrix">Toeplitz matrix</a>, such as in signal processing or cyclic signals.</li>
<li><a href="http://en.wikipedia.org/wiki/Kalman_filter">Kalman filtering</a> (or linear quadratic estimation): often used for determining position and motion of a moving object based on sensor information (e.g., for drawing a vehicle&#8217;s position on a map using GPS data, or for aircraft or spacecraft navigation based on sensor inputs)</li>
</ul>


<p>To get your hands dirty,</p>

<ul>
<li>Install Statsample with <code>gem install statsample</code>.</li>
<li>Next, install the TimeSeries extension with <code>gem install statsample-timeseries</code>.</li>
</ul>


<p>EDIT: Statsample-timeseries now uses <a href="www.github.com/v0dro/daru/">daru</a> for data storage and cleaning. Thus all ephemeral time series statistics functions (moving average, acf, etc.) have been moved to Daru::Vector, which can be indexed on a DateTimeIndex, which lets you access data indexed by a time stamp. See the <a href="https://github.com/v0dro/daru/blob/master/README.md">daru README</a> for examples.</p>

<p><code>Statsample::TimeSeries::Series</code> has been deprecated in favour of <code>Daru::Vector</code>.</p>

<p>To demonstrate:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;daru&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;statsample-timeseries&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">ts</span> <span class="o">=</span> <span class="no">Daru</span><span class="o">::</span><span class="no">Vector</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">100</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="nb">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="p">},</span> <span class="n">index</span><span class="p">:</span> <span class="no">Daru</span><span class="o">::</span><span class="no">DateTimeIndex</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="ss">:start</span> <span class="o">=&gt;</span> <span class="s1">&#39;2012-2&#39;</span><span class="p">,</span> <span class="ss">:periods</span> <span class="o">=&gt;</span> <span class="mi">100</span><span class="p">))</span>
</span><span class='line'><span class="n">ts</span><span class="o">.</span><span class="n">acf</span> <span class="c1"># Calculate auto-correlation</span>
</span><span class='line'><span class="n">ts</span><span class="o">.</span><span class="n">pacf</span> <span class="c1"># Calculate partial autocorrelation</span>
</span><span class='line'><span class="c1"># Partial autocorrelation with 11 lags by maximum likelihood estimation</span>
</span><span class='line'><span class="n">ts</span><span class="o">.</span><span class="n">pacf</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;mle&#39;</span><span class="p">)</span>
</span><span class='line'><span class="n">ts</span><span class="o">.</span><span class="n">ar</span> <span class="c1"># Autoregressive coefficients</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># ARIMA(2, 1, 1)</span>
</span><span class='line'><span class="n">k_obj</span> <span class="o">=</span> <span class="no">Statsample</span><span class="o">::</span><span class="no">TimeSeries</span><span class="o">.</span><span class="n">arima</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span class='line'><span class="n">k_obj</span><span class="o">.</span><span class="n">ar</span> <span class="c1"># autoregressive coefficients</span>
</span><span class='line'><span class="n">k_obj</span><span class="o">.</span><span class="n">ma</span> <span class="c1"># moving average coefficients</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Statsample GLM</h2>

<p><a href="https://rubygems.org/gems/statsample-glm"><em>Statsample GLM</em></a> includes many helpful regression techniques, which can be used for regression analysis on data.
Some of those techniques are:</p>

<ul>
<li><a href="http://en.wikipedia.org/wiki/Poisson_regression">Poisson Regression</a>: used to model contingency tables and counts</li>
<li><a href="http://en.wikipedia.org/wiki/Logistic_regression">Logistic Regression</a></li>
<li>Exponential Regression: one case of <a href="http://en.wikipedia.org/wiki/Nonlinear_regression">nonlinear regression</a> (examples might include the <a href="http://mathbits.com/MathBits/TISection/Statistics2/exponential.htm">temperature of a cup of coffee</a> left in a cold room, or the decay of an orbit)</li>
<li><a href="http://en.wikipedia.org/wiki/Iteratively_reweighted_least_squares">Iteratively Reweighted Least Squares</a>: used to mitigate the effects of outliers</li>
</ul>


<p>The top level module for regression techniques is <code>Statsample::GLM</code>.</p>

<p>Using it is as simple as ever:</p>

<ul>
<li>First, install <code>statsample</code> by <code>gem install statsample</code>.</li>
<li>Then, install GLM by <code>gem install</code>statsample-glm`.</li>
</ul>


<p>Let&#8217;s get started:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;daru&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;statsample-glm&#39;</span>
</span><span class='line'><span class="c1"># Create the datasets:</span>
</span><span class='line'><span class="n">x1</span> <span class="o">=</span> <span class="no">Daru</span><span class="o">::</span><span class="no">Vector</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="o">[</span><span class="mi">0</span><span class="o">.</span><span class="mi">537322309644812</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">717124209978434</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">519166718891331</span><span class="p">,</span><span class="mi">0</span><span class="o">.</span><span class="mi">434970973986765</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">761822002215759</span><span class="p">,</span><span class="mi">1</span><span class="o">.</span><span class="mi">51170030921189</span><span class="p">,</span><span class="mi">0</span><span class="o">.</span><span class="mi">883854199811195</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">908689798854196</span><span class="p">,</span><span class="mi">1</span><span class="o">.</span><span class="mi">70331977539793</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">246971150634099</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">.</span><span class="mi">59077593922623</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">721548040910253</span><span class="p">,</span><span class="mi">0</span><span class="o">.</span><span class="mi">467025703920194</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">510132788447137</span><span class="p">,</span><span class="mi">0</span><span class="o">.</span><span class="mi">430106510266798</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">144353683251536</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">.</span><span class="mi">54943800728303</span><span class="p">,</span><span class="mi">0</span><span class="o">.</span><span class="mi">849307651309298</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">640304240933579</span><span class="p">,</span><span class="mi">1</span><span class="o">.</span><span class="mi">31462478279425</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">399783455165345</span><span class="p">,</span><span class="mi">0</span><span class="o">.</span><span class="mo">0453055645017</span><span class="mi">902</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="o">.</span><span class="mi">58212161987746</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">.</span><span class="mi">16484414309359</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">.</span><span class="mi">08829266466281</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">243893919684792</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">.</span><span class="mi">96655661929441</span><span class="p">,</span><span class="mi">0</span><span class="o">.</span><span class="mi">301335373291024</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">665832694463588</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mo">0120650</span><span class="mi">855753837</span><span class="p">,</span><span class="mi">1</span><span class="o">.</span><span class="mi">5116066367604</span><span class="p">,</span><span class="mi">0</span><span class="o">.</span><span class="mi">557300353673344</span><span class="p">,</span><span class="mi">1</span><span class="o">.</span><span class="mi">12829931872045</span><span class="p">,</span><span class="mi">0</span><span class="o">.</span><span class="mi">234443748015922</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="o">.</span><span class="mo">034</span><span class="mi">86690662651</span><span class="p">,</span><span class="mi">0</span><span class="o">.</span><span class="mi">275544751380246</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">231465849558696</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">356880153225012</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">57746647541923</span><span class="p">,</span><span class="mi">1</span><span class="o">.</span><span class="mi">35758352580655</span><span class="p">,</span><span class="mi">1</span><span class="o">.</span><span class="mi">23971669378224</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">662466275100489</span><span class="p">,</span><span class="mi">0</span><span class="o">.</span><span class="mi">313263561921793</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">.</span><span class="mi">08783223256362</span><span class="p">,</span><span class="mi">1</span><span class="o">.</span><span class="mi">41964722846899</span><span class="p">,</span><span class="mi">1</span><span class="o">.</span><span class="mi">29325100940785</span><span class="p">,</span><span class="mi">0</span><span class="o">.</span><span class="mi">72153880625103</span><span class="p">,</span><span class="mi">0</span><span class="o">.</span><span class="mi">440580131022748</span><span class="p">,</span><span class="mi">0</span><span class="o">.</span><span class="mo">0351</span><span class="mi">917814720056</span><span class="p">,</span> <span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">142353224879252</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'><span class="n">x2</span> <span class="o">=</span> <span class="no">Daru</span><span class="o">::</span><span class="no">Vector</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="o">[-</span><span class="mi">0</span><span class="o">.</span><span class="mi">866655707911859</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">367820249977585</span><span class="p">,</span><span class="mi">0</span><span class="o">.</span><span class="mi">361486610435</span><span class="p">,</span><span class="mi">0</span><span class="o">.</span><span class="mi">857332626245179</span><span class="p">,</span><span class="mi">0</span><span class="o">.</span><span class="mi">133438466268095</span><span class="p">,</span><span class="mi">0</span><span class="o">.</span><span class="mi">716104533073575</span><span class="p">,</span><span class="mi">1</span><span class="o">.</span><span class="mi">77206093023382</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">10136697295802</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">777086491435508</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">204573554913706</span><span class="p">,</span><span class="mi">0</span><span class="o">.</span><span class="mi">963353531412233</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">.</span><span class="mi">10103024900542</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">404372761837392</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">230226345183469</span><span class="p">,</span><span class="mi">0</span><span class="o">.</span><span class="mo">0363730246</span><span class="mi">866971</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">838265540390497</span><span class="p">,</span><span class="mi">1</span><span class="o">.</span><span class="mi">12543549657924</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">57929175648001</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">747060244805248</span><span class="p">,</span><span class="mi">0</span><span class="o">.</span><span class="mi">58946979365152</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">531952663697324</span><span class="p">,</span><span class="mi">1</span><span class="o">.</span><span class="mi">53338594419818</span><span class="p">,</span><span class="mi">0</span><span class="o">.</span><span class="mi">521992029051441</span><span class="p">,</span><span class="mi">1</span><span class="o">.</span><span class="mi">41631763288724</span><span class="p">,</span><span class="mi">0</span><span class="o">.</span><span class="mi">611402316795129</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">518355638373296</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">515192557101107</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">672697937866108</span><span class="p">,</span><span class="mi">1</span><span class="o">.</span><span class="mi">84347042325327</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">21195540664804</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">269869371631611</span><span class="p">,</span><span class="mi">0</span><span class="o">.</span><span class="mi">296155694010096</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="o">.</span><span class="mi">18097898069634</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">.</span><span class="mi">21314663927206</span><span class="p">,</span><span class="mi">1</span><span class="o">.</span><span class="mi">49193669881581</span><span class="p">,</span><span class="mi">1</span><span class="o">.</span><span class="mi">38969280369493</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">400680808117106</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">.</span><span class="mi">87282814976479</span><span class="p">,</span><span class="mi">1</span><span class="o">.</span><span class="mi">82394870451051</span><span class="p">,</span><span class="mi">0</span><span class="o">.</span><span class="mi">637864732838274</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">141155946382493</span><span class="p">,</span><span class="mi">0</span><span class="o">.</span><span class="mo">06</span><span class="mi">99950644281617</span><span class="p">,</span><span class="mi">1</span><span class="o">.</span><span class="mi">32568550595165</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">412599258349398</span><span class="p">,</span><span class="mi">0</span><span class="o">.</span><span class="mi">14436832227506</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">.</span><span class="mi">16507785388489</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="o">.</span><span class="mi">16782049922428</span><span class="p">,</span><span class="mi">0</span><span class="o">.</span><span class="mi">24318371493798</span><span class="p">,</span><span class="mi">0</span><span class="o">.</span><span class="mi">258954871320764</span><span class="p">,</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">151966534521183</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">y</span> <span class="o">=</span> <span class="no">Daru</span><span class="o">::</span><span class="no">Vector</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="o">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">x</span> <span class="o">=</span> <span class="no">Daru</span><span class="o">::</span><span class="no">DataFrame</span><span class="o">.</span><span class="n">new</span><span class="p">({</span><span class="s2">&quot;x1&quot;</span><span class="o">=&gt;</span><span class="n">x1</span><span class="p">,</span><span class="s2">&quot;x2&quot;</span><span class="o">=&gt;</span><span class="n">x2</span><span class="p">})</span>
</span><span class='line'>
</span><span class='line'><span class="n">obj</span> <span class="o">=</span> <span class="no">Statsample</span><span class="o">::</span><span class="no">GLM</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="ss">:binomial</span><span class="p">)</span>
</span><span class='line'><span class="c1"># =&gt; Returns logistic regression object</span>
</span></code></pre></td></tr></table></div></figure>


<p>The <a href="http://rubydoc.info/gems/statsample-glm/Statsample/Regression">documentation and API details is available here</a></p>

<p>We have some more plans for GLM module. First in the list is to make the algorithms work with singular value decomposition, because manual inversion of matrices is not fun for larger values in a Poisson regression.</p>

<h2>Conclusion</h2>

<p>I have <a href="http://ankurgoel.com">blogged about most of the functionalities</a>; additional information is available there.</p>

<p>For more updated use cases refer to the notebooks in the respective project READMEs.</p>

<p>Please explore and use the libraries; I eagerly await your input, suggestions and questions. Feel free to leave any questions on <a href="http://github.com/SciRuby/statsample-glm/issues">the Statsample GLM tracker</a> or <a href="[the%20Statsample%20GLM%20tracker](http://github.com/SciRuby/statsample-glm/issues">the Statsample TimeSeries tracker</a>.</p>

<p>I had an amazing summer!</p>

<p>Stay tuned and Enjoy.</p>
]]></content>
  </entry>
  
</feed>
